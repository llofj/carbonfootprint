"use strict";(self["webpackChunkecopaw"]=self["webpackChunkecopaw"]||[]).push([[720],{4921:(e,t,a)=>{a.r(t),a.d(t,{default:()=>X});var n=a(6768),r={class:"virtual-pet-page"};function s(e,t,a,s,i,o){var l=(0,n.g2)("VirtualPet");return(0,n.uX)(),(0,n.CE)("div",r,[(0,n.bF)(l)])}a(2010),a(9868);var i=a(4232),o=a(5130);const l=a.p+"img/nailong.1d8eaf4b.png";var c={class:"virtual-pet-page"},u={class:"pet-container"},p={class:"pet-info-card"},d={class:"pet-name"},f={class:"pet-stats"},k={class:"stat"},v={class:"stat"},h={class:"stat"},b={class:"pet-animation-container"},m={class:"pet-actions"},g=["disabled"],L=["disabled"],w=["disabled"],A={class:"steps-container"},x={class:"steps-info"},C={key:0,class:"carbon-info"},E={key:1,class:"coins-info"},S={class:"steps-input"};function y(e,t,a,r,s,y){return(0,n.uX)(),(0,n.CE)("div",c,[t[15]||(t[15]=(0,n.Lk)("h2",null,"我的虚拟宠物",-1)),(0,n.Lk)("div",u,[(0,n.Lk)("div",p,[(0,n.Lk)("div",d,(0,i.v_)(s.pet.name),1),(0,n.Lk)("div",f,[(0,n.Lk)("div",k,[t[5]||(t[5]=(0,n.Lk)("i",{class:"fa fa-star"},null,-1)),(0,n.Lk)("span",null,"等级: "+(0,i.v_)(s.pet.level),1)]),(0,n.Lk)("div",v,[t[6]||(t[6]=(0,n.Lk)("i",{class:"fa fa-heart"},null,-1)),(0,n.Lk)("span",null,"健康: "+(0,i.v_)(s.pet.health),1)]),(0,n.Lk)("div",h,[t[7]||(t[7]=(0,n.Lk)("i",{class:"fa fa-coins"},null,-1)),(0,n.Lk)("span",null,"金币: "+(0,i.v_)(s.pet.coins),1)])])]),(0,n.Lk)("div",b,[(0,n.Lk)("div",{class:(0,i.C4)(["pet-animation",s.animationClass])},t[8]||(t[8]=[(0,n.Lk)("img",{src:l,alt:"奶龙",class:"pet-image"},null,-1)]),2)]),(0,n.Lk)("div",m,[(0,n.Lk)("button",{onClick:t[0]||(t[0]=function(){return y.feedPet&&y.feedPet.apply(y,arguments)}),disabled:s.pet.coins<10,class:"action-btn feed-btn"},t[9]||(t[9]=[(0,n.Lk)("i",{class:"fa fa-utensils"},null,-1),(0,n.eW)(" 喂食 (10金币) ")]),8,g),(0,n.Lk)("button",{onClick:t[1]||(t[1]=function(){return y.trainPet&&y.trainPet.apply(y,arguments)}),disabled:s.pet.coins<20,class:"action-btn train-btn"},t[10]||(t[10]=[(0,n.Lk)("i",{class:"fa fa-dumbbell"},null,-1),(0,n.eW)(" 训练 (20金币) ")]),8,L),(0,n.Lk)("button",{onClick:t[2]||(t[2]=function(){return y.levelUp&&y.levelUp.apply(y,arguments)}),disabled:s.pet.coins<100,class:"action-btn level-up-btn"},t[11]||(t[11]=[(0,n.Lk)("i",{class:"fa fa-arrow-up"},null,-1),(0,n.eW)(" 升级 (100金币) ")]),8,w)])]),(0,n.Lk)("div",A,[t[13]||(t[13]=(0,n.Lk)("h3",null,"微信步数",-1)),(0,n.Lk)("p",x,"今日步数: "+(0,i.v_)(s.steps)+" 步",1),s.carbonReduction?((0,n.uX)(),(0,n.CE)("p",C,"减少碳排放: "+(0,i.v_)(s.carbonReduction.toFixed(2))+" kg CO2",1)):(0,n.Q3)("",!0),s.coinsEarned?((0,n.uX)(),(0,n.CE)("p",E,"获得金币: "+(0,i.v_)(s.coinsEarned),1)):(0,n.Q3)("",!0),(0,n.Lk)("div",S,[(0,n.bo)((0,n.Lk)("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=function(e){return s.simulatedSteps=e}),placeholder:"输入步数",min:"1000",max:"30000"},null,512),[[o.Jo,s.simulatedSteps]]),(0,n.Lk)("button",{onClick:t[4]||(t[4]=function(){return y.submitSteps&&y.submitSteps.apply(y,arguments)}),class:"submit-steps-btn"},t[12]||(t[12]=[(0,n.Lk)("i",{class:"fa fa-walking"},null,-1),(0,n.eW)(" 提交步数 ")]))]),t[14]||(t[14]=(0,n.Lk)("div",{class:"steps-note"},[(0,n.Lk)("p",null,"注: 在实际应用中，步数将从微信API获取")],-1))]),t[16]||(t[16]=(0,n.Lk)("div",{class:"info-section"},[(0,n.Lk)("h3",null,"步行减排说明"),(0,n.Lk)("ul",null,[(0,n.Lk)("li",null,"每走1000步可减少约0.1kg碳排放"),(0,n.Lk)("li",null,"每减少1kg碳排放可获得10个金币"),(0,n.Lk)("li",null,"金币可用于喂食、训练和升级宠物"),(0,n.Lk)("li",null,"宠物等级越高，减排效果越好")])],-1))])}var _=a(4048),P=a(388),I=(a(8706),a(4114),a(6031),a(8407)),R=a.n(I);const T={data:function(){return{pet:{name:"奶龙",level:1,health:"健康",coins:0},steps:0,simulatedSteps:8e3,carbonReduction:0,coinsEarned:0,animationClass:"",animationTimeout:null}},created:function(){var e=this;return(0,P.A)((0,_.A)().mark((function t(){var a,n;return(0,_.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,a=localStorage.getItem("token"),a){t.next=5;break}return e.$router.push("/"),t.abrupt("return");case 5:return t.next=7,R().get("http://localhost:5000/api/pet",{headers:{Authorization:"Bearer ".concat(a)}});case 7:n=t.sent,e.pet=n.data,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),console.error("Error fetching pet data:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},methods:{submitSteps:function(){var e=this;return(0,P.A)((0,_.A)().mark((function t(){var a,n;return(0,_.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(e.simulatedSteps<1e3)){t.next=4;break}return alert("步数太少，请至少输入1000步"),t.abrupt("return");case 4:return a=localStorage.getItem("token"),t.next=7,R().post("http://localhost:5000/api/pet/steps",{steps:e.simulatedSteps},{headers:{Authorization:"Bearer ".concat(a)}});case 7:n=t.sent,e.pet=n.data.pet,e.steps=n.data.stepsProcessed,e.carbonReduction=n.data.carbonReduction,e.coinsEarned=n.data.coinsEarned,e.playAnimation("bounce"),alert("步数提交成功！减少了".concat(n.data.carbonReduction.toFixed(2),"kg碳排放，获得了").concat(n.data.coinsEarned,"金币！")),t.next=20;break;case 16:t.prev=16,t.t0=t["catch"](0),console.error("Error submitting steps:",t.t0),alert("提交步数失败，请重试");case 20:case"end":return t.stop()}}),t,null,[[0,16]])})))()},feedPet:function(){var e=this;return(0,P.A)((0,_.A)().mark((function t(){var a,n;return(0,_.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(e.pet.coins<10)){t.next=4;break}return alert("金币不足，无法喂食"),t.abrupt("return");case 4:return a=localStorage.getItem("token"),t.next=7,R().post("http://localhost:5000/api/pet/feed",{},{headers:{Authorization:"Bearer ".concat(a)}});case 7:n=t.sent,e.pet=n.data.pet,e.playAnimation("wiggle"),alert(n.data.message),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](0),console.error("Error feeding pet:",t.t0),alert("喂食失败，请重试");case 17:case"end":return t.stop()}}),t,null,[[0,13]])})))()},trainPet:function(){var e=this;return(0,P.A)((0,_.A)().mark((function t(){var a,n;return(0,_.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(e.pet.coins<20)){t.next=4;break}return alert("金币不足，无法训练"),t.abrupt("return");case 4:return a=localStorage.getItem("token"),t.next=7,R().post("http://localhost:5000/api/pet/train",{},{headers:{Authorization:"Bearer ".concat(a)}});case 7:n=t.sent,e.pet=n.data.pet,e.playAnimation("shake"),alert(n.data.message),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](0),console.error("Error training pet:",t.t0),alert("训练失败，请重试");case 17:case"end":return t.stop()}}),t,null,[[0,13]])})))()},levelUp:function(){var e=this;return(0,P.A)((0,_.A)().mark((function t(){var a,n;return(0,_.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!(e.pet.coins<100)){t.next=4;break}return alert("金币不足，升级需要100金币"),t.abrupt("return");case 4:return a=localStorage.getItem("token"),t.next=7,R().post("http://localhost:5000/api/pet/level-up",{},{headers:{Authorization:"Bearer ".concat(a)}});case 7:n=t.sent,e.pet=n.data.pet,e.playAnimation("grow"),alert(n.data.message),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](0),console.error("Error leveling up pet:",t.t0),alert("升级失败，请重试");case 17:case"end":return t.stop()}}),t,null,[[0,13]])})))()},playAnimation:function(e){var t=this;this.animationTimeout&&clearTimeout(this.animationTimeout),this.animationClass=e,this.animationTimeout=setTimeout((function(){t.animationClass=""}),1500)}}};var z=a(1241);const B=(0,z.A)(T,[["render",y],["__scopeId","data-v-456acc36"]]),F=B,U={components:{VirtualPet:F}},W=(0,z.A)(U,[["render",s],["__scopeId","data-v-15cbab12"]]),X=W},9868:(e,t,a)=>{var n=a(6518),r=a(9504),s=a(1291),i=a(1240),o=a(2333),l=a(9039),c=RangeError,u=String,p=Math.floor,d=r(o),f=r("".slice),k=r(1..toFixed),v=function(e,t,a){return 0===t?a:t%2===1?v(e,t-1,a*e):v(e*e,t/2,a)},h=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},b=function(e,t,a){var n=-1,r=a;while(++n<6)r+=t*e[n],e[n]=r%1e7,r=p(r/1e7)},m=function(e,t){var a=6,n=0;while(--a>=0)n+=e[a],e[a]=p(n/t),n=n%t*1e7},g=function(e){var t=6,a="";while(--t>=0)if(""!==a||0===t||0!==e[t]){var n=u(e[t]);a=""===a?n:a+d("0",7-n.length)+n}return a},L=l((function(){return"0.000"!==k(8e-5,3)||"1"!==k(.9,0)||"1.25"!==k(1.255,2)||"1000000000000000128"!==k(0xde0b6b3a7640080,0)}))||!l((function(){k({})}));n({target:"Number",proto:!0,forced:L},{toFixed:function(e){var t,a,n,r,o=i(this),l=s(e),p=[0,0,0,0,0,0],k="",L="0";if(l<0||l>20)throw new c("Incorrect fraction digits");if(o!==o)return"NaN";if(o<=-1e21||o>=1e21)return u(o);if(o<0&&(k="-",o=-o),o>1e-21)if(t=h(o*v(2,69,1))-69,a=t<0?o*v(2,-t,1):o/v(2,t,1),a*=4503599627370496,t=52-t,t>0){b(p,0,a),n=l;while(n>=7)b(p,1e7,0),n-=7;b(p,v(10,n,1),0),n=t-1;while(n>=23)m(p,1<<23),n-=23;m(p,1<<n),b(p,1,1),m(p,2),L=g(p)}else b(p,0,a),b(p,1<<-t,0),L=g(p)+d("0",l);return l>0?(r=L.length,L=k+(r<=l?"0."+d("0",l-r)+L:f(L,0,r-l)+"."+f(L,r-l))):L=k+L,L}})}}]);
//# sourceMappingURL=720.f9c57e58.js.map