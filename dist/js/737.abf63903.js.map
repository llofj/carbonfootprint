{"version":3,"file":"js/737.abf63903.js","mappings":"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","sources":["webpack://ecopaw/./src/views/Login.vue","webpack://ecopaw/./src/components/LoginForm.vue","webpack://ecopaw/./src/components/LoginForm.vue?dcb9","webpack://ecopaw/./src/views/Login.vue?240b"],"sourcesContent":["<template>\r\n    <div class=\"login-page\">\r\n      <LoginForm />\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import LoginForm from '../components/LoginForm.vue';\r\n  \r\n  export default {\r\n    components: {\r\n      LoginForm\r\n    }\r\n  };\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .login-page {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    height: 100vh;\r\n    background-color: #f5f5f5;\r\n  }\r\n  </style>","<template>\n  <div class=\"login-form\">\n    <h2>登录</h2>\n    <form @submit.prevent=\"handleSubmit\">\n      <div class=\"form-group\">\n        <label for=\"username\">账号:</label>\n        <input \n          type=\"text\" \n          id=\"username\" \n          v-model.trim=\"username\" \n          required \n          :disabled=\"isLoading\"\n          @input=\"clearError\"\n        />\n      </div>\n      <div class=\"form-group\">\n        <label for=\"password\">密码:</label>\n        <div class=\"password-input\">\n          <input \n            :type=\"showPassword ? 'text' : 'password'\" \n            id=\"password\" \n            v-model=\"password\" \n            required \n            :disabled=\"isLoading\"\n            @input=\"clearError\"\n          />\n          <i \n            class=\"fas\" \n            :class=\"showPassword ? 'fa-eye-slash' : 'fa-eye'\"\n            @click=\"togglePassword\"\n          ></i>\n        </div>\n      </div>\n      <div class=\"form-group\">\n        <label for=\"captcha\">验证码:</label>\n        <div class=\"captcha-group\">\n          <div class=\"captcha-input\">\n            <input \n              type=\"text\" \n              id=\"captcha\" \n              v-model.trim=\"captcha\" \n              required \n              :disabled=\"isLoading\"\n              @input=\"clearError\"\n              maxlength=\"4\"\n              placeholder=\"请输入验证码 (0000)\"\n            />\n          </div>\n          <div class=\"captcha-code\">\n            0000\n          </div>\n        </div>\n      </div>\n      <button type=\"submit\" :disabled=\"isLoading || !isFormValid\">\n        <span v-if=\"isLoading\">\n          <i class=\"fas fa-spinner fa-spin\"></i> 登录中...\n        </span>\n        <span v-else>登录</span>\n      </button>\n      <div v-if=\"errorMessage\" class=\"error-container\">\n        <i class=\"fas fa-exclamation-circle\"></i>\n        {{ errorMessage }}\n      </div>\n    </form>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport { API_URLS, axiosConfig } from '../config/api';\n\nconst api = axios.create(axiosConfig);\n\nexport default {\n  data() {\n    return {\n      username: '',\n      password: '',\n      captcha: '0000',\n      errorMessage: '',\n      isLoading: false,\n      showPassword: false\n    };\n  },\n  computed: {\n    isFormValid() {\n      return this.username.trim() && \n             this.password && \n             this.captcha.trim() === '0000';\n    }\n  },\n  methods: {\n    clearError() {\n      this.errorMessage = '';\n    },\n    togglePassword() {\n      this.showPassword = !this.showPassword;\n    },\n    async handleSubmit() {\n      if (!this.isFormValid) {\n        if (this.captcha.trim() !== '0000') {\n          this.errorMessage = '验证码错误，请输入0000';\n          return;\n        }\n        return;\n      }\n      \n      this.isLoading = true;\n      this.errorMessage = '';\n      \n      try {\n        const loginData = {\n          username: this.username.trim(),\n          password: this.password.trim(),\n          captcha: this.captcha.trim()\n        };\n        \n        console.log('正在发送登录请求:', {\n          url: `${axiosConfig.baseURL}${API_URLS.login}`,\n          username: loginData.username\n        });\n        \n        try {\n          const response = await api.post(API_URLS.login, loginData);\n          \n          console.log('服务器响应:', response.data);\n          \n          if (response.data && response.data.token) {\n            // 登录成功\n            localStorage.setItem('token', response.data.token);\n            localStorage.setItem('username', this.username.trim());\n            \n            const redirect = this.$route.query.redirect || '/';\n            await this.$router.push(redirect);\n            return;\n          }\n          \n          // 如果没有token但服务器返回了消息\n          if (response.data && response.data.message) {\n            this.errorMessage = response.data.message;\n            return;\n          }\n        } catch (apiError) {\n          console.error('API调用错误:', apiError);\n          \n          // 处理API错误响应\n          if (apiError.response) {\n            const status = apiError.response.status;\n            const errorData = apiError.response.data;\n            \n            switch (status) {\n              case 401:\n                this.errorMessage = '账号或密码错误';\n                break;\n              case 403:\n                this.errorMessage = '验证码错误';\n                break;\n              case 500:\n                this.errorMessage = '服务器错误，请稍后重试';\n                break;\n              default:\n                this.errorMessage = errorData?.message || '登录失败，请稍后重试';\n            }\n            \n            // 在这里不要尝试备用登录，让错误显示给用户\n            return;\n          }\n          \n          // 如果是网络错误或服务器未响应，则尝试备用登录\n          console.log('网络错误或服务器未响应，尝试备用登录');\n        }\n        \n        // 在API调用完全失败或没有有效响应的情况下，执行备用登录\n        console.log('尝试备用登录...');\n        if (this.username.trim().toLowerCase() === 'test' && this.password.trim() === '123456') {\n          console.log('备用登录成功');\n          localStorage.setItem('token', 'mock-token-12345');\n          localStorage.setItem('username', this.username.trim());\n          \n          const redirect = this.$route.query.redirect || '/';\n          await this.$router.push(redirect);\n          return;\n        }\n        \n        this.errorMessage = '无法连接到服务器，请检查网络连接';\n        \n      } catch (error) {\n        console.error('登录过程中发生意外错误:', error);\n        this.errorMessage = '登录过程中发生错误，请稍后重试';\n      } finally {\n        this.isLoading = false;\n      }\n    }\n  },\n  created() {\n    if (localStorage.getItem('token')) {\n      const redirect = this.$route.query.redirect || '/';\n      this.$router.push(redirect);\n    }\n  }\n};\n</script>\n\n<style scoped>\n.login-form {\n  width: 100%;\n  max-width: 400px;\n  margin: 2rem auto;\n  padding: 2rem;\n  border-radius: 10px;\n  background-color: white;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n}\n\n.login-form h2 {\n  text-align: center;\n  color: #1e3d59;\n  margin-bottom: 2rem;\n  font-size: 1.8rem;\n}\n\n.form-group {\n  margin-bottom: 1.5rem;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 0.5rem;\n  font-weight: 500;\n  color: #666;\n}\n\n.form-group input {\n  width: 100%;\n  padding: 0.75rem;\n  border: 2px solid #e0e0e0;\n  border-radius: 6px;\n  font-size: 1rem;\n  transition: all 0.3s ease;\n}\n\n.form-group input:focus {\n  outline: none;\n  border-color: #17a2b8;\n  box-shadow: 0 0 0 3px rgba(23, 162, 184, 0.2);\n}\n\n.form-group input:disabled {\n  background-color: #f5f5f5;\n  cursor: not-allowed;\n}\n\n.password-input {\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.password-input i {\n  position: absolute;\n  right: 12px;\n  color: #666;\n  cursor: pointer;\n  padding: 4px;\n  transition: color 0.3s ease;\n}\n\n.password-input i:hover {\n  color: #17a2b8;\n}\n\n.captcha-group {\n  display: flex;\n  gap: 1rem;\n  align-items: flex-start;\n}\n\n.captcha-input {\n  flex: 1;\n}\n\n.captcha-code {\n  width: 100px;\n  height: 44px;\n  border-radius: 6px;\n  background-color: #f0f0f0;\n  border: 2px solid #e0e0e0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.5rem;\n  font-weight: bold;\n  color: #333;\n  letter-spacing: 2px;\n}\n\nbutton[type=\"submit\"] {\n  width: 100%;\n  padding: 0.75rem;\n  background-color: #17a2b8;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 1rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 0.5rem;\n}\n\nbutton[type=\"submit\"]:hover:not(:disabled) {\n  background-color: #138496;\n  transform: translateY(-1px);\n}\n\nbutton[type=\"submit\"]:disabled {\n  background-color: #ccc;\n  cursor: not-allowed;\n  transform: none;\n}\n\n.error-container {\n  margin-top: 1rem;\n  padding: 0.75rem;\n  background-color: #fff5f5;\n  border: 1px solid #fed7d7;\n  border-radius: 6px;\n  color: #dc3545;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-size: 0.9rem;\n}\n\n.error-container i {\n  font-size: 1rem;\n}\n\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n.fa-spinner {\n  animation: spin 1s linear infinite;\n}\n</style>","import { render } from \"./LoginForm.vue?vue&type=template&id=68daf821&scoped=true\"\nimport script from \"./LoginForm.vue?vue&type=script&lang=js\"\nexport * from \"./LoginForm.vue?vue&type=script&lang=js\"\n\nimport \"./LoginForm.vue?vue&type=style&index=0&id=68daf821&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-68daf821\"]])\n\nexport default __exports__","import { render } from \"./Login.vue?vue&type=template&id=408f1459&scoped=true\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\n\nimport \"./Login.vue?vue&type=style&index=0&id=408f1459&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-408f1459\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_LoginForm","key","_createElementVNode","onSubmit","_cache","_withModifiers","$options","handleSubmit","apply","arguments","_hoisted_2","for","type","id","$event","$data","username","required","disabled","isLoading","onInput","clearError","_hoisted_3","trim","_hoisted_4","_hoisted_5","showPassword","password","_hoisted_6","_normalizeClass","onClick","togglePassword","_hoisted_7","_hoisted_8","_hoisted_9","captcha","maxlength","placeholder","_hoisted_10","isFormValid","_hoisted_12","_createTextVNode","_hoisted_13","_hoisted_11","errorMessage","_hoisted_14","_toDisplayString","_createCommentVNode","api","axios","axiosConfig","data","computed","this","methods","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","loginData","response","redirect","status","errorData","_redirect","wrap","_context","prev","next","abrupt","console","log","url","concat","baseURL","API_URLS","login","post","sent","token","localStorage","setItem","$route","query","$router","push","message","t0","error","t1","toLowerCase","t2","finish","stop","created","getItem","__exports__","components","LoginForm","render"],"sourceRoot":""}