(()=>{"use strict";var e={4809:(e,t,n)=>{n.d(t,{A:()=>b});n(44114);var r=n(56768),a=n(45130),o=n(24232),s={class:"navbar",ref:"navbar"},i={class:"navbar-brand"},c={class:"navbar-menu"},u={class:"navbar-end"},l={key:1,class:"username"};function d(e,t,n,d,h,p){var f=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("nav",s,[(0,r.Lk)("div",i,[(0,r.bF)(f,{to:"/",class:"logo"},{default:(0,r.k6)((function(){return t[5]||(t[5]=[(0,r.eW)("EcoPaw")])})),_:1})]),(0,r.Lk)("div",c,[(0,r.bF)(f,{to:"/calculator",class:"nav-item"},{default:(0,r.k6)((function(){return t[6]||(t[6]=[(0,r.eW)("碳计算器")])})),_:1}),(0,r.Lk)("a",{onClick:t[0]||(t[0]=(0,a.D$)((function(e){return p.handleAuthRequired("/pet")}),["prevent"])),class:(0,o.C4)(["nav-item",{disabled:!h.isLoggedIn}])},"虚拟宠物",2),(0,r.Lk)("a",{onClick:t[1]||(t[1]=(0,a.D$)((function(e){return p.handleAuthRequired("/achievements")}),["prevent"])),class:(0,o.C4)(["nav-item",{disabled:!h.isLoggedIn}])},"成就系统",2),(0,r.Lk)("a",{onClick:t[2]||(t[2]=(0,a.D$)((function(e){return p.handleAuthRequired("/ranking")}),["prevent"])),class:(0,o.C4)(["nav-item",{disabled:!h.isLoggedIn}])},"排名系统",2)]),(0,r.Lk)("div",u,[h.isLoggedIn?((0,r.uX)(),(0,r.CE)("div",l,[(0,r.eW)((0,o.v_)(h.username)+" ",1),(0,r.Lk)("button",{onClick:t[4]||(t[4]=function(){return p.handleLogout&&p.handleLogout.apply(p,arguments)}),class:"logout-btn"},"退出")])):((0,r.uX)(),(0,r.CE)("div",{key:0,onClick:t[3]||(t[3]=function(t){return e.$router.push("/login")}),class:"user-icon"},t[7]||(t[7]=[(0,r.Lk)("i",{class:"fas fa-user"},null,-1)])))])],512)}var h=n(50788),p=n.n(h),f=n(32674);p().create(f.by);const v={name:"Navbar",data:function(){return{isLoggedIn:!1,username:""}},methods:{handleAuthRequired:function(e){this.isLoggedIn?this.$router.push(e):this.$router.push({path:"/login",query:{redirect:e}})},checkLoginStatus:function(){var e=localStorage.getItem("token");this.isLoggedIn=!!e,this.isLoggedIn&&(this.username=localStorage.getItem("username")||"用户")},handleLogout:function(){localStorage.removeItem("token"),localStorage.removeItem("username"),this.isLoggedIn=!1,this.username="",this.$router.push("/")},handleStorageChange:function(e){"token"!==e.key&&"username"!==e.key||this.checkLoginStatus()},handleScroll:function(){this.$refs.navbar&&(window.scrollY>20?this.$refs.navbar.classList.add("scrolled"):this.$refs.navbar.classList.remove("scrolled"))}},created:function(){this.checkLoginStatus(),window.addEventListener("storage",this.handleStorageChange)},mounted:function(){window.addEventListener("scroll",this.handleScroll)},beforeUnmount:function(){window.removeEventListener("storage",this.handleStorageChange),window.removeEventListener("scroll",this.handleScroll)}};var g=n(71241);const m=(0,g.A)(v,[["render",d],["__scopeId","data-v-e18f20c0"]]),b=m},12313:(e,t,n)=>{n(23792),n(3362),n(69085),n(9391);var r=n(45130),a=n(56768),o={id:"app"};function s(e,t,n,r,s,i){var c=(0,a.g2)("router-view"),u=(0,a.g2)("Message");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.bF)(c),(0,a.bF)(u)])}var i=n(24232);function c(e,t,n,o,s,c){return(0,a.uX)(),(0,a.Wv)(r.eB,{name:"fade"},{default:(0,a.k6)((function(){return[e.show?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,i.C4)(["message",e.type])},(0,i.v_)(e.content),3)):(0,a.Q3)("",!0)]})),_:1})}var u=n(41034),l=n(60782);const d={name:"Message",computed:(0,u.A)({},(0,l.aH)("message",["show","content","type"]))};var h=n(71241);const p=(0,h.A)(d,[["render",c],["__scopeId","data-v-20839754"]]),f=p,v={name:"App",components:{Message:f}},g=(0,h.A)(v,[["render",s]]),m=g;n(15086),n(18111),n(13579),n(26099),n(47764),n(62953);var b=n(81387),k=(n(23288),{class:"home"}),L={class:"hero-section"},w={class:"hero-content"},y={class:"features-section"},C={class:"container"},A={class:"features-grid"},E={class:"feature-card"},S={key:0,class:"login-required"},I={key:0,class:"login-required"},_={key:0,class:"login-required"},q={class:"footer"},x={class:"footer-content"},R={class:"copyright"};function P(e,t,n,o,s,c){var u=(0,a.g2)("Navbar"),l=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",k,[(0,a.bF)(u),(0,a.Lk)("div",L,[(0,a.Lk)("div",w,[t[4]||(t[4]=(0,a.Lk)("h1",{class:"hero-title"},"计算您的碳足迹",-1)),t[5]||(t[5]=(0,a.Lk)("p",{class:"hero-subtitle"},"减碳，让时光更轻盈",-1)),(0,a.bF)(l,{to:"/calculator",class:"cta-button"},{default:(0,a.k6)((function(){return t[3]||(t[3]=[(0,a.Lk)("span",null,"开始计算",-1)])})),_:1})])]),t[18]||(t[18]=(0,a.Lk)("div",{class:"intro-section"},[(0,a.Lk)("h2",{class:"intro-title"},"为什么选择 EcoPaw?"),(0,a.Lk)("p",{class:"intro-text"}," EcoPaw 是一个创新的碳足迹管理平台，通过游戏化的方式帮助您追踪和减少碳排放。 我们相信，每个人都可以为环保做出贡献，而且这个过程可以变得有趣而有意义。 ")],-1)),(0,a.Lk)("div",y,[(0,a.Lk)("div",C,[t[16]||(t[16]=(0,a.Lk)("h2",{class:"section-title"},"功能介绍",-1)),(0,a.Lk)("div",A,[(0,a.Lk)("div",E,[(0,a.bF)(l,{to:"/calculator"},{default:(0,a.k6)((function(){return t[6]||(t[6]=[(0,a.Lk)("i",{class:"fas fa-calculator feature-icon"},null,-1),(0,a.Lk)("h3",null,"碳计算器",-1),(0,a.Lk)("p",null,"计算您的日常碳足迹",-1)])})),_:1})]),(0,a.Lk)("div",{class:(0,i.C4)(["feature-card",{disabled:!s.isLoggedIn}])},[(0,a.Lk)("a",{onClick:t[0]||(t[0]=(0,r.D$)((function(e){return c.handleAuthRequired("/pet")}),["prevent"]))},[t[7]||(t[7]=(0,a.Lk)("i",{class:"fas fa-paw feature-icon"},null,-1)),t[8]||(t[8]=(0,a.Lk)("h3",null,"虚拟宠物",-1)),t[9]||(t[9]=(0,a.Lk)("p",null,"培养您的环保小伙伴",-1)),s.isLoggedIn?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("span",S,"需要登录"))])],2),(0,a.Lk)("div",{class:(0,i.C4)(["feature-card",{disabled:!s.isLoggedIn}])},[(0,a.Lk)("a",{onClick:t[1]||(t[1]=(0,r.D$)((function(e){return c.handleAuthRequired("/achievements")}),["prevent"]))},[t[10]||(t[10]=(0,a.Lk)("i",{class:"fas fa-trophy feature-icon"},null,-1)),t[11]||(t[11]=(0,a.Lk)("h3",null,"成就系统",-1)),t[12]||(t[12]=(0,a.Lk)("p",null,"解锁环保成就",-1)),s.isLoggedIn?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("span",I,"需要登录"))])],2),(0,a.Lk)("div",{class:(0,i.C4)(["feature-card",{disabled:!s.isLoggedIn}])},[(0,a.Lk)("a",{onClick:t[2]||(t[2]=(0,r.D$)((function(e){return c.handleAuthRequired("/ranking")}),["prevent"]))},[t[13]||(t[13]=(0,a.Lk)("i",{class:"fas fa-chart-line feature-icon"},null,-1)),t[14]||(t[14]=(0,a.Lk)("h3",null,"排名系统",-1)),t[15]||(t[15]=(0,a.Lk)("p",null,"查看环保排行榜",-1)),s.isLoggedIn?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("span",_,"需要登录"))])],2)])])]),(0,a.Lk)("div",q,[(0,a.Lk)("div",x,[t[17]||(t[17]=(0,a.Fv)('<div class="footer-logo" data-v-bb00d1a6>EcoPaw</div><p class="footer-text" data-v-bb00d1a6> 携手共建绿色未来，让每一个环保行动都成为点亮地球的星光。 </p><div class="social-icons" data-v-bb00d1a6><a href="https://www.deepseek.com/" target="_blank" class="social-icon" title="DeepSeek" data-v-bb00d1a6><i class="fas fa-brain" data-v-bb00d1a6></i></a><a href="https://www.carbonmonitor.org.cn/" target="_blank" class="social-icon" title="Carbon Monitor" data-v-bb00d1a6><i class="fas fa-chart-line" data-v-bb00d1a6></i></a></div>',3)),(0,a.Lk)("div",R," © "+(0,i.v_)((new Date).getFullYear())+" EcoPaw. 保留所有权利. ",1)])])])}n(44114);var O=n(4809);const T={name:"Home",components:{Navbar:O.A},data:function(){return{isLoggedIn:!1}},created:function(){this.checkLoginStatus(),window.addEventListener("storage",this.checkLoginStatus)},beforeUnmount:function(){window.removeEventListener("storage",this.checkLoginStatus)},methods:{handleAuthRequired:function(e){this.isLoggedIn?this.$router.push(e):this.$router.push({path:"/login",query:{redirect:e}})},checkLoginStatus:function(){this.isLoggedIn=!!localStorage.getItem("token")}}},j=(0,h.A)(T,[["render",P],["__scopeId","data-v-bb00d1a6"]]),U=j;var $=[{path:"/",name:"Home",component:U},{path:"/calculator",name:"CarbonCalculator",component:function(){return n.e(637).then(n.bind(n,74637))}},{path:"/carbon-reduction",name:"CarbonReduction",component:function(){return n.e(947).then(n.bind(n,25947))},meta:{requiresAuth:!0}},{path:"/pet",name:"VirtualPet",component:function(){return n.e(933).then(n.bind(n,30744))},meta:{requiresAuth:!0}},{path:"/achievements",name:"Achievements",component:function(){return n.e(57).then(n.bind(n,59057))},meta:{requiresAuth:!0}},{path:"/ranking",name:"Ranking",component:function(){return n.e(976).then(n.bind(n,20976))},meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:function(){return n.e(511).then(n.bind(n,82892))}},{path:"/register",name:"Register",component:function(){return n.e(703).then(n.bind(n,83703))}}],D=(0,b.aE)({history:(0,b.LA)("/"),routes:$});D.beforeEach((function(e,t,n){var r=!!localStorage.getItem("token");e.matched.some((function(e){return e.meta.requiresAuth}))?r?n():n({path:"/login",query:{redirect:e.fullPath}}):n()}));const F=D;var M=n(14048),N=n(30388),X=n(32674),H=(n(76031),{show:!1,content:"",type:"info"}),B={SHOW_MESSAGE:function(e,t){var n=t.content,r=t.type,a=void 0===r?"info":r;e.show=!0,e.content=n,e.type=a},HIDE_MESSAGE:function(e){e.show=!1}},W={showMessage:function(e,t){var n=e.commit,r=t.content,a=t.type,o=void 0===a?"info":a;n("SHOW_MESSAGE",{content:r,type:o}),setTimeout((function(){n("HIDE_MESSAGE")}),5e3)}};const G={namespaced:!0,state:H,mutations:B,actions:W},Q=(0,l.y$)({state:{user:null,pet:{name:"小绿",level:1,health:"健康"},achievements:[],leaderboard:[],userCarbonReduction:0},mutations:{setUser:function(e,t){e.user=t},updatePet:function(e,t){e.pet=t},setAchievements:function(e,t){e.achievements=t},setLeaderboard:function(e,t){e.leaderboard=t},setUserCarbonReduction:function(e,t){e.userCarbonReduction=t}},actions:{login:function(e,t){var n=e.commit;n("setUser",t)},fetchAchievements:function(e){var t=e.commit,n=["绿色饮食达人","低碳通勤者"];t("setAchievements",n)},fetchLeaderboard:function(e){var t=e.commit,n=[{name:"用户A",reduction:5.2},{name:"用户B",reduction:4.8}];t("setLeaderboard",n)},fetchUserCarbonReduction:function(e){return(0,N.A)((0,M.A)().mark((function t(){var n,r;return(0,M.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.prev=1,t.next=4,(0,X.dw)().get("/achievement/carbon-reduction");case 4:r=t.sent,r.data&&void 0!==r.data.carbon_reduction&&n("setUserCarbonReduction",r.data.carbon_reduction),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.error("获取用户减碳总量失败:",t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()},updateUserCarbonReduction:function(e){return(0,N.A)((0,M.A)().mark((function t(){var n,r,a;return(0,M.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,t.prev=1,r=(new Date).getTime(),t.next=5,(0,X.dw)().get("/achievement/carbon-reduction?_t=".concat(r));case 5:if(a=t.sent,!a.data||void 0===a.data.carbon_reduction){t.next=10;break}return n("setUserCarbonReduction",a.data.carbon_reduction),console.log("已更新用户减碳总量:",a.data.carbon_reduction),t.abrupt("return",a.data.carbon_reduction);case 10:return t.abrupt("return",0);case 13:return t.prev=13,t.t0=t["catch"](1),console.error("更新用户减碳总量失败:",t.t0),t.abrupt("return",0);case 17:case"end":return t.stop()}}),t,null,[[1,13]])})))()},syncLeaderboardWithCarbonReduction:function(e){return(0,N.A)((0,M.A)().mark((function t(){var n,r,a;return(0,M.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.dispatch,t.prev=1,console.log("开始同步排名系统与减碳总量..."),t.next=5,n("updateUserCarbonReduction");case 5:return r=t.sent,console.log("获取到最新减碳总量:",r),t.next=9,(0,X.dw)().post("/leaderboard/update");case 9:return a=t.sent,console.log("排名同步完成:",a.data),t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t["catch"](1),console.error("同步排名系统失败:",t.t0),t.abrupt("return",!1);case 18:case"end":return t.stop()}}),t,null,[[1,14]])})))()}},getters:{isLoggedIn:function(e){return!!e.user},currentUserCarbonReduction:function(e){return e.userCarbonReduction}},modules:{message:G}});var Y=n(50788),Z=n.n(Y);Z().interceptors.request.use(X.ZU),Z().interceptors.response.use(X.Lv.success,X.Lv.error);var z=(0,r.Ef)(m);z.use(F),z.use(Q),z.mount("#app")},32674:(e,t,n)=>{n.d(t,{Lv:()=>h,ZU:()=>d,by:()=>l,dw:()=>p,yl:()=>u});var r=n(41034),a=(n(28706),n(26099),n(50788)),o=n.n(a),s=!1,i=function(){var e=window.location.hostname,t=window.location.protocol;return s?"localhost"===e||"127.0.0.1"===e?"http://localhost:5000/api":"http://".concat(e,":5000/api"):"".concat(t,"//").concat(e,":5000/api")},c=i();console.log("API基础URL:",c);var u={login:"/auth/login",logout:"/auth/logout",register:"/auth/register",captcha:"/auth/captcha",profile:"/user/profile",calculator:"/carbon/calculate",pet:"/pet",achievements:"/achievement",ranking:"/leaderboard"},l={baseURL:c,timeout:15e3,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json, image/svg+xml"}},d=function(e){if(console.log("请求拦截器处理请求:",e.url),e.url===u.captcha)return e.headers["Accept"]="image/svg+xml",e.responseType="text",e;var t=localStorage.getItem("token");if(t&&(e.headers.Authorization="Bearer ".concat(t)),e.data)try{var n=(0,r.A)({},e.data);n.password&&(n.password="******"),console.log("请求数据:",n)}catch(a){console.error("请求日志记录失败:",a)}return e},h={success:function(e){return console.log("响应拦截器接收到响应:",{url:e.config.url,status:e.status,statusText:e.statusText}),e},error:function(e){return console.error("API Error:",e),e.response?(console.log("错误响应信息:",{status:e.response.status,statusText:e.response.statusText,data:e.response.data}),401===e.response.status&&(localStorage.removeItem("token"),localStorage.removeItem("username"),"/login"!==window.location.pathname&&(window.location.href="/login"))):e.request?console.log("没有收到响应:",e.request):console.log("请求设置错误:",e.message),Promise.reject(e)}},p=function(){var e=o().create(l);return e.interceptors.request.use(d,(function(e){return Promise.reject(e)})),e.interceptors.response.use(h.success,h.error),e}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.m=e,(()=>{var e=[];n.O=(t,r,a,o)=>{if(!r){var s=1/0;for(l=0;l<e.length;l++){for(var[r,a,o]=e[l],i=!0,c=0;c<r.length;c++)(!1&o||s>=o)&&Object.keys(n.O).every((e=>n.O[e](r[c])))?r.splice(c--,1):(i=!1,o<s&&(s=o));if(i){e.splice(l--,1);var u=a();void 0!==u&&(t=u)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[r,a,o]}})(),(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return n.d(t,{a:t}),t}})(),(()=>{n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[]))})(),(()=>{n.u=e=>"js/"+e+"."+{57:"4f5ec68d",511:"aaeb3462",637:"69a2e001",703:"c52b01a1",933:"c769426e",947:"67ed2593",976:"ed0a17fa"}[e]+".js"})(),(()=>{n.miniCssF=e=>"css/"+e+"."+{57:"a46abd28",511:"08057b97",637:"0b2daf88",703:"969d43d1",933:"0c7161e7",947:"f68831b6",976:"40c3e3a3"}[e]+".css"})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={},t="ecopaw:";n.l=(r,a,o,s)=>{if(e[r])e[r].push(a);else{var i,c;if(void 0!==o)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+o){i=d;break}}i||(c=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,n.nc&&i.setAttribute("nonce",n.nc),i.setAttribute("data-webpack",t+o),i.src=r),e[r]=[a];var h=(t,n)=>{i.onerror=i.onload=null,clearTimeout(p);var a=e[r];if(delete e[r],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach((e=>e(n))),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=h.bind(null,i.onerror),i.onload=h.bind(null,i.onload),c&&document.head.appendChild(i)}}})(),(()=>{n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{n.p="/"})(),(()=>{if("undefined"!==typeof document){var e=(e,t,r,a,o)=>{var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",n.nc&&(s.nonce=n.nc);var i=n=>{if(s.onerror=s.onload=null,"load"===n.type)a();else{var r=n&&n.type,i=n&&n.target&&n.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+r+": "+i+")");c.name="ChunkLoadError",c.code="CSS_CHUNK_LOAD_FAILED",c.type=r,c.request=i,s.parentNode&&s.parentNode.removeChild(s),o(c)}};return s.onerror=s.onload=i,s.href=t,r?r.parentNode.insertBefore(s,r.nextSibling):document.head.appendChild(s),s},t=(e,t)=>{for(var n=document.getElementsByTagName("link"),r=0;r<n.length;r++){var a=n[r],o=a.getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(o===e||o===t))return a}var s=document.getElementsByTagName("style");for(r=0;r<s.length;r++){a=s[r],o=a.getAttribute("data-href");if(o===e||o===t)return a}},r=r=>new Promise(((a,o)=>{var s=n.miniCssF(r),i=n.p+s;if(t(s,i))return a();e(r,i,null,a,o)})),a={524:0};n.f.miniCss=(e,t)=>{var n={57:1,511:1,637:1,703:1,933:1,947:1,976:1};a[e]?t.push(a[e]):0!==a[e]&&n[e]&&t.push(a[e]=r(e).then((()=>{a[e]=0}),(t=>{throw delete a[e],t})))}}})(),(()=>{var e={524:0};n.f.j=(t,r)=>{var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var o=new Promise(((n,r)=>a=e[t]=[n,r]));r.push(a[2]=o);var s=n.p+n.u(t),i=new Error,c=r=>{if(n.o(e,t)&&(a=e[t],0!==a&&(e[t]=void 0),a)){var o=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",i.name="ChunkLoadError",i.type=o,i.request=s,a[1](i)}};n.l(s,c,"chunk-"+t,t)}},n.O.j=t=>0===e[t];var t=(t,r)=>{var a,o,[s,i,c]=r,u=0;if(s.some((t=>0!==e[t]))){for(a in i)n.o(i,a)&&(n.m[a]=i[a]);if(c)var l=c(n)}for(t&&t(r);u<s.length;u++)o=s[u],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(l)},r=self["webpackChunkecopaw"]=self["webpackChunkecopaw"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n.O(void 0,[504],(()=>n(12313)));r=n.O(r)})();
//# sourceMappingURL=app.54c094cc.js.map