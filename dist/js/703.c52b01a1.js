"use strict";(self["webpackChunkecopaw"]=self["webpackChunkecopaw"]||[]).push([[703],{83703:(e,r,a)=>{a.r(r),a.d(r,{default:()=>$});var t=a(56768),s={class:"register-page"},n={class:"register-container"};function o(e,r,a,o,i,c){var l=(0,t.g2)("RegisterForm");return(0,t.uX)(),(0,t.CE)("div",s,[(0,t.Lk)("div",n,[(0,t.bF)(l)])])}var i=a(45130),c=a(24232),l={class:"register-form"},u={class:"form-group"},d=["disabled"],p={class:"form-group"},h=["disabled"],f={class:"form-group"},m={class:"password-input"},g=["type","disabled"],b={class:"form-group"},k={class:"password-input"},w=["type","disabled"],L={class:"form-group"},v={class:"captcha-group"},y={class:"captcha-input"},C=["disabled"],P=["disabled"],M={key:0},x={key:1},E={key:0,class:"error-container"},I={class:"login-link"};function S(e,r,a,s,n,o){var S=(0,t.g2)("router-link");return(0,t.uX)(),(0,t.CE)("div",l,[r[23]||(r[23]=(0,t.Lk)("h2",null,"注册新用户",-1)),(0,t.Lk)("form",{onSubmit:r[13]||(r[13]=(0,i.D$)((function(){return o.handleSubmit&&o.handleSubmit.apply(o,arguments)}),["prevent"]))},[(0,t.Lk)("div",u,[r[14]||(r[14]=(0,t.Lk)("label",{for:"username"},"用户名:",-1)),(0,t.bo)((0,t.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":r[0]||(r[0]=function(e){return n.username=e}),required:"",disabled:n.isLoading,onInput:r[1]||(r[1]=function(){return o.clearError&&o.clearError.apply(o,arguments)}),placeholder:"请输入用户名"},null,40,d),[[i.Jo,n.username,void 0,{trim:!0}]])]),(0,t.Lk)("div",p,[r[15]||(r[15]=(0,t.Lk)("label",{for:"email"},"邮箱:",-1)),(0,t.bo)((0,t.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":r[2]||(r[2]=function(e){return n.email=e}),required:"",disabled:n.isLoading,onInput:r[3]||(r[3]=function(){return o.clearError&&o.clearError.apply(o,arguments)}),placeholder:"请输入邮箱"},null,40,h),[[i.Jo,n.email,void 0,{trim:!0}]])]),(0,t.Lk)("div",f,[r[16]||(r[16]=(0,t.Lk)("label",{for:"password"},"密码:",-1)),(0,t.Lk)("div",m,[(0,t.bo)((0,t.Lk)("input",{type:n.showPassword?"text":"password",id:"password","onUpdate:modelValue":r[4]||(r[4]=function(e){return n.password=e}),required:"",disabled:n.isLoading,onInput:r[5]||(r[5]=function(){return o.clearError&&o.clearError.apply(o,arguments)}),placeholder:"请输入密码"},null,40,g),[[i.hp,n.password]]),(0,t.Lk)("i",{class:(0,c.C4)(["fas",n.showPassword?"fa-eye-slash":"fa-eye"]),onClick:r[6]||(r[6]=function(){return o.togglePassword&&o.togglePassword.apply(o,arguments)})},null,2)])]),(0,t.Lk)("div",b,[r[17]||(r[17]=(0,t.Lk)("label",{for:"confirmPassword"},"确认密码:",-1)),(0,t.Lk)("div",k,[(0,t.bo)((0,t.Lk)("input",{type:n.showConfirmPassword?"text":"password",id:"confirmPassword","onUpdate:modelValue":r[7]||(r[7]=function(e){return n.confirmPassword=e}),required:"",disabled:n.isLoading,onInput:r[8]||(r[8]=function(){return o.clearError&&o.clearError.apply(o,arguments)}),placeholder:"请再次输入密码"},null,40,w),[[i.hp,n.confirmPassword]]),(0,t.Lk)("i",{class:(0,c.C4)(["fas",n.showConfirmPassword?"fa-eye-slash":"fa-eye"]),onClick:r[9]||(r[9]=function(){return o.toggleConfirmPassword&&o.toggleConfirmPassword.apply(o,arguments)})},null,2)])]),(0,t.Lk)("div",L,[r[18]||(r[18]=(0,t.Lk)("label",{for:"captcha"},"验证码:",-1)),(0,t.Lk)("div",v,[(0,t.Lk)("div",y,[(0,t.bo)((0,t.Lk)("input",{type:"text",id:"captcha","onUpdate:modelValue":r[10]||(r[10]=function(e){return n.captchaInput=e}),required:"",disabled:n.isLoading,onInput:r[11]||(r[11]=function(){return o.clearError&&o.clearError.apply(o,arguments)}),maxlength:"4",pattern:"[0-9]{4}",placeholder:"请输入验证码"},null,40,C),[[i.Jo,n.captchaInput]])]),(0,t.Lk)("div",{class:"captcha-code",onClick:r[12]||(r[12]=function(){return o.generateCaptcha&&o.generateCaptcha.apply(o,arguments)}),title:"当前验证码为随机生成"},[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(n.captchaDisplay,(function(e,r){return(0,t.uX)(),(0,t.CE)("span",{key:r,style:(0,c.Tr)(o.getRandomStyle())},(0,c.v_)(e),5)})),128))])])]),(0,t.Lk)("button",{type:"submit",disabled:n.isLoading||!o.isFormValid},[n.isLoading?((0,t.uX)(),(0,t.CE)("span",M,r[19]||(r[19]=[(0,t.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1),(0,t.eW)(" 注册中... ")]))):((0,t.uX)(),(0,t.CE)("span",x,"注册"))],8,P),n.errorMessage?((0,t.uX)(),(0,t.CE)("div",E,[r[20]||(r[20]=(0,t.Lk)("i",{class:"fas fa-exclamation-circle"},null,-1)),(0,t.eW)(" "+(0,c.v_)(n.errorMessage),1)])):(0,t.Q3)("",!0),(0,t.Lk)("div",I,[r[22]||(r[22]=(0,t.eW)(" 已有账号? ")),(0,t.bF)(S,{to:"/login"},{default:(0,t.k6)((function(){return r[21]||(r[21]=[(0,t.eW)("点击登录")])})),_:1})])],32)])}var F=a(14048),V=a(30388),X=(a(76918),a(28706),a(44114),a(23288),a(26099),a(38781),a(42762),a(76031),a(50788)),_=a.n(X),q=a(32674),A=_().create(q.by);const U={data:function(){return{username:"",email:"",password:"",confirmPassword:"",captchaInput:"",captchaDisplay:"",systemCaptcha:"",errorMessage:"",isLoading:!1,showPassword:!1,showConfirmPassword:!1,refreshCount:0}},computed:{isFormValid:function(){return this.username.trim()&&this.email.trim()&&this.password&&this.password===this.confirmPassword&&this.captchaInput&&4===this.captchaInput.length}},created:function(){this.generateCaptcha()},methods:{clearError:function(){this.errorMessage=""},togglePassword:function(){this.showPassword=!this.showPassword},toggleConfirmPassword:function(){this.showConfirmPassword=!this.showConfirmPassword},generateCaptcha:function(){var e=Math.floor(1e3+9e3*Math.random()),r=e.toString();this.captchaDisplay=r,this.systemCaptcha=r,this.captchaInput="";var a=document.querySelector(".captcha-code");a&&this.refreshCount>0&&(a.classList.add("refreshing"),setTimeout((function(){a.classList.remove("refreshing")}),500)),this.refreshCount++,console.log("生成新验证码: ".concat(this.systemCaptcha))},getRandomStyle:function(){var e=Math.floor(10*Math.random())-5,r=14+Math.floor(4*Math.random()),a=Math.floor(3*Math.random())-1;return{transform:"rotate(".concat(e,"deg)"),fontSize:"".concat(r,"px"),letterSpacing:"".concat(a,"px"),display:"inline-block",fontWeight:"bold",margin:"0 2px"}},handleSubmit:function(){var e=this;return(0,V.A)((0,F.A)().mark((function r(){var a,t,s,n;return(0,F.A)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.isFormValid){r.next=5;break}if(e.password===e.confirmPassword){r.next=4;break}return e.errorMessage="两次输入的密码不一致",r.abrupt("return");case 4:return r.abrupt("return");case 5:if(e.captchaInput===e.systemCaptcha){r.next=11;break}return console.log('验证码比对失败: 用户输入="'.concat(e.captchaInput,'", 系统验证码="').concat(e.systemCaptcha,'"')),e.errorMessage="验证码错误，请重新输入",e.captchaInput="",e.generateCaptcha(),r.abrupt("return");case 11:return console.log("验证码校验通过，准备提交注册请求"),e.isLoading=!0,e.errorMessage="",r.prev=14,a={username:e.username.trim(),email:e.email.trim(),password:e.password,captcha:"0000"},console.log("正在发送注册请求:",{用户名:a.username,邮箱:a.email,验证码:"固定发送0000"}),r.next=19,A.post(q.yl.register,a);case 19:if(t=r.sent,console.log("服务器响应:",t.data),!t.data||"注册成功"!==t.data.message){r.next=24;break}return e.$router.push("/login?registered=true"),r.abrupt("return");case 24:if(!t.data||!t.data.message){r.next=28;break}return e.errorMessage=t.data.message,e.generateCaptcha(),r.abrupt("return");case 28:r.next=51;break;case 30:if(r.prev=30,r.t0=r["catch"](14),console.error("注册过程中发生错误:",r.t0),!r.t0.response){r.next=49;break}s=r.t0.response.status,n=r.t0.response.data,r.t1=s,r.next=400===r.t1?39:409===r.t1?41:500===r.t1?43:45;break;case 39:return e.errorMessage=n.message||"注册信息有误，请检查输入",r.abrupt("break",46);case 41:return e.errorMessage="用户名已存在，请选择其他用户名",r.abrupt("break",46);case 43:return e.errorMessage="服务器错误，请稍后重试",r.abrupt("break",46);case 45:e.errorMessage=(null===n||void 0===n?void 0:n.message)||"注册失败，请稍后重试";case 46:e.generateCaptcha(),r.next=51;break;case 49:e.errorMessage="无法连接到服务器，请检查网络连接",e.generateCaptcha();case 51:return r.prev=51,e.isLoading=!1,r.finish(51);case 54:case"end":return r.stop()}}),r,null,[[14,30,51,54]])})))()}}};var W=a(71241);const D=(0,W.A)(U,[["render",S],["__scopeId","data-v-abb91018"]]),R=D,J={components:{RegisterForm:R}},T=(0,W.A)(J,[["render",o],["__scopeId","data-v-2dfda6be"]]),$=T}}]);
//# sourceMappingURL=703.c52b01a1.js.map