"use strict";(self["webpackChunkecopaw"]=self["webpackChunkecopaw"]||[]).push([[637],{9868:(e,t,a)=>{var s=a(46518),n=a(79504),i=a(91291),c=a(31240),r=a(72333),o=a(79039),l=RangeError,u=String,f=Math.floor,d=n(r),v=n("".slice),g=n(1..toFixed),k=function(e,t,a){return 0===t?a:t%2===1?k(e,t-1,a*e):k(e*e,t/2,a)},p=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},h=function(e,t,a){var s=-1,n=a;while(++s<6)n+=t*e[s],e[s]=n%1e7,n=f(n/1e7)},m=function(e,t){var a=6,s=0;while(--a>=0)s+=e[a],e[a]=f(s/t),s=s%t*1e7},C=function(e){var t=6,a="";while(--t>=0)if(""!==a||0===t||0!==e[t]){var s=u(e[t]);a=""===a?s:a+d("0",7-s.length)+s}return a},L=o((function(){return"0.000"!==g(8e-5,3)||"1"!==g(.9,0)||"1.25"!==g(1.255,2)||"1000000000000000128"!==g(0xde0b6b3a7640080,0)}))||!o((function(){g({})}));s({target:"Number",proto:!0,forced:L},{toFixed:function(e){var t,a,s,n,r=c(this),o=i(e),f=[0,0,0,0,0,0],g="",L="0";if(o<0||o>20)throw new l("Incorrect fraction digits");if(r!==r)return"NaN";if(r<=-1e21||r>=1e21)return u(r);if(r<0&&(g="-",r=-r),r>1e-21)if(t=p(r*k(2,69,1))-69,a=t<0?r*k(2,-t,1):r/k(2,t,1),a*=4503599627370496,t=52-t,t>0){h(f,0,a),s=o;while(s>=7)h(f,1e7,0),s-=7;h(f,k(10,s,1),0),s=t-1;while(s>=23)m(f,1<<23),s-=23;m(f,1<<s),h(f,1,1),m(f,2),L=C(f)}else h(f,0,a),h(f,1<<-t,0),L=C(f)+d("0",o);return o>0?(n=L.length,L=g+(n<=o?"0."+d("0",o-n)+L:v(L,0,n-o)+"."+v(L,n-o))):L=g+L,L}})},74637:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ae});var s=a(56768),n={class:"calculator-page"},i={class:"calculator-container"},c={class:"nav-controls"},r={class:"back-to-home"},o={class:"switch-calculator"},l={class:"page-content"};function u(e,t,a,u,f,d){var v=(0,s.g2)("Navbar"),g=(0,s.g2)("CarbonCalculator");return(0,s.uX)(),(0,s.CE)("div",n,[(0,s.bF)(v),(0,s.Lk)("div",i,[(0,s.Lk)("div",c,[(0,s.Lk)("div",r,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=function(){return u.goHome&&u.goHome.apply(u,arguments)}),class:"back-btn"},t[2]||(t[2]=[(0,s.Lk)("i",{class:"fas fa-home"},null,-1),(0,s.Lk)("span",null,"返回主页",-1)]))]),(0,s.Lk)("div",o,[(0,s.Lk)("button",{class:"switch-btn",onClick:t[1]||(t[1]=function(){return u.switchToReductionCalculator&&u.switchToReductionCalculator.apply(u,arguments)})},t[3]||(t[3]=[(0,s.Lk)("i",{class:"fas fa-exchange-alt"},null,-1),(0,s.eW)(" 切换到减碳计算器 ")]))])]),(0,s.Lk)("div",l,[t[4]||(t[4]=(0,s.Lk)("h1",{class:"page-title"},"碳排放计算器",-1)),t[5]||(t[5]=(0,s.Lk)("p",{class:"description"},"通过记录日常活动，了解您的碳排放量",-1)),(0,s.bF)(g)])])])}a(44114);var f=a(4809),d=(a(28706),a(24232)),v=a(45130),g={class:"carbon-calculator"},k={class:"calculator-container"},p={class:"category-list"},h=["onClick"],m={class:"emission-list"},C={class:"emission-items-wrapper"},L=["onClick"],y={class:"emission-icon"},b={class:"emission-info"},I={class:"emission-factor"},w={class:"factor-value"},E={class:"calculation-panel"},F={class:"selected-emissions"},x={class:"panel-header"},T={key:0,class:"no-emissions"},_={key:1,class:"emission-inputs"},A={class:"category-group-header"},X={class:"emission-header"},O=["onClick"],S={class:"input-group"},U=["onUpdate:modelValue","placeholder"],W={class:"unit"},N={class:"emission-amount"},K={class:"emission-value"},M={class:"total-emission"},R={class:"total-header"},V={class:"total-value"},H={class:"tree-equivalent"},P={class:"tree-count"};function j(e,t,a,n,i,c){return(0,s.uX)(),(0,s.CE)("div",g,[(0,s.Lk)("div",k,[(0,s.Lk)("div",p,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(c.sortedCategories,(function(e){return(0,s.uX)(),(0,s.CE)("div",{key:e,class:(0,d.C4)(["category-item",{active:i.activeCategory===e}]),onClick:function(t){return c.setActiveCategory(e)}},[(0,s.Lk)("i",{class:(0,d.C4)(c.getCategoryIcon(e))},null,2),(0,s.Lk)("span",null,(0,d.v_)(e),1)],10,h)})),128))]),(0,s.Lk)("div",m,[t[3]||(t[3]=(0,s.Lk)("div",{class:"emission-list-header"},[(0,s.Lk)("h3",null,"排放源"),(0,s.Lk)("p",{class:"emission-hint"},"点击添加到计算器")],-1)),(0,s.Lk)("div",C,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(c.filteredEmissions,(function(e,a){return(0,s.uX)(),(0,s.CE)("div",{key:a,class:(0,d.C4)(["emission-item-card",{selected:c.isSelected(i.activeCategory,a)}]),onClick:function(e){return c.selectSubcategory(i.activeCategory,a)}},[(0,s.Lk)("div",y,[(0,s.Lk)("i",{class:(0,d.C4)(c.getCategoryIcon(i.activeCategory,a))},null,2)]),(0,s.Lk)("div",b,[(0,s.Lk)("h3",null,(0,d.v_)(a),1),(0,s.Lk)("div",I,[t[2]||(t[2]=(0,s.Lk)("span",null,"排放系数：",-1)),(0,s.Lk)("span",w,(0,d.v_)(e)+" kgCO₂e/"+(0,d.v_)(c.getUnit(a)),1)])])],10,L)})),128))])]),(0,s.Lk)("div",E,[(0,s.Lk)("div",F,[(0,s.Lk)("div",x,[t[5]||(t[5]=(0,s.Lk)("h3",null,"已选排放源",-1)),i.selectedItems.length>0?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"clear-all-btn",onClick:t[0]||(t[0]=function(){return c.clearAllItems&&c.clearAllItems.apply(c,arguments)}),title:"清空所有选择的排放源"},t[4]||(t[4]=[(0,s.Lk)("i",{class:"fas fa-trash-alt"},null,-1),(0,s.Lk)("span",null,"清空",-1)]))):(0,s.Q3)("",!0)]),0===i.selectedItems.length?((0,s.uX)(),(0,s.CE)("div",T,t[6]||(t[6]=[(0,s.Lk)("i",{class:"fas fa-info-circle"},null,-1),(0,s.Lk)("p",null,"请从左侧选择排放源",-1)]))):((0,s.uX)(),(0,s.CE)("div",_,[t[10]||(t[10]=(0,s.Lk)("div",{class:"input-limit-hint"},[(0,s.Lk)("i",{class:"fas fa-info-circle"}),(0,s.Lk)("span",null,"输入数据最多支持三位数(单位:kgCO₂e)")],-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(c.groupedSelectedItems,(function(e,a){return(0,s.uX)(),(0,s.CE)("div",{key:a,class:"category-group"},[(0,s.Lk)("div",A,[(0,s.Lk)("i",{class:(0,d.C4)(c.getCategoryIcon(a))},null,2),(0,s.Lk)("span",null,(0,d.v_)(a),1)]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,(function(e){return(0,s.uX)(),(0,s.CE)("div",{key:"".concat(e.category,"-").concat(e.subCategory),class:"emission-input-item"},[(0,s.Lk)("div",X,[(0,s.Lk)("span",null,[(0,s.Lk)("i",{class:(0,d.C4)(c.getCategoryIcon(e.category,e.subCategory))},null,2),(0,s.eW)(" "+(0,d.v_)(e.subCategory),1)]),(0,s.Lk)("button",{class:"remove-btn",onClick:function(t){return c.removeItem(e)},title:"移除项目"},t[7]||(t[7]=[(0,s.Lk)("i",{class:"fas fa-times"},null,-1)]),8,O)]),(0,s.Lk)("div",S,[(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":function(t){return e.value=t},min:"0.1",step:"0.1",onInput:t[1]||(t[1]=function(){return c.calculateTotal&&c.calculateTotal.apply(c,arguments)}),placeholder:"输入"+c.getUnit(e.subCategory)},null,40,U),[[v.Jo,e.value,void 0,{number:!0}]]),(0,s.Lk)("span",W,(0,d.v_)(c.getUnit(e.subCategory)),1)]),(0,s.Lk)("div",N,[t[8]||(t[8]=(0,s.eW)(" 排放量：")),(0,s.Lk)("span",K,(0,d.v_)(c.getEmissionValue(e)),1),t[9]||(t[9]=(0,s.eW)(" kgCO₂e "))])])})),128))])})),128))]))]),(0,s.Lk)("div",M,[(0,s.Lk)("div",R,[t[11]||(t[11]=(0,s.Lk)("h3",null,"总排放量",-1)),(0,s.Lk)("span",V,(0,d.v_)(i.totalEmission)+" kgCO₂e",1)]),(0,s.Lk)("div",H,[t[14]||(t[14]=(0,s.Lk)("i",{class:"fas fa-tree tree-icon"},null,-1)),(0,s.Lk)("span",null,[t[12]||(t[12]=(0,s.eW)("需要种植 ")),(0,s.Lk)("span",P,(0,d.v_)(i.treesToPlant),1),t[13]||(t[13]=(0,s.eW)(" 棵树抵消这些碳排放"))])])])])])])}var q=a(3604),z=a(14048),B=a(30388),J=(a(48980),a(51629),a(25276),a(15086),a(26910),a(54554),a(18111),a(7588),a(13579),a(9868),a(79432),a(26099),a(23500),a(76031),a(50788)),Q=a.n(J);const $={data:function(){return{activeCategory:"",emissionFactors:{},unitMap:{},selectedItems:[],totalEmission:0,treesToPlant:0,categoryOrder:["衣","食","住","行","用"]}},created:function(){var e=this;return(0,B.A)((0,z.A)().mark((function t(){var a,s;return(0,z.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,a=localStorage.getItem("token"),a){t.next=5;break}return e.$router.push("/"),t.abrupt("return");case 5:return t.next=7,Q().get("http://localhost:5000/api/carbon/factors",{headers:{Authorization:"Bearer ".concat(a)}});case 7:s=t.sent,e.emissionFactors=s.data.factors,e.unitMap=s.data.units,Object.keys(e.emissionFactors).length>0&&(e.activeCategory=e.sortedCategories[0]),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),console.error("Error:",t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))()},computed:{sortedCategories:function(){var e=this,t=Object.keys(this.emissionFactors);return t.sort((function(t,a){var s=e.categoryOrder.indexOf(t),n=e.categoryOrder.indexOf(a);return s-n}))},filteredEmissions:function(){return this.emissionFactors[this.activeCategory]||{}},groupedSelectedItems:function(){var e=this,t={};return this.categoryOrder.forEach((function(a){e.selectedItems.some((function(e){return e.category===a}))&&(t[a]=[])})),this.selectedItems.forEach((function(e){t[e.category]||(t[e.category]=[]),t[e.category].push(e)})),t}},methods:{setActiveCategory:function(e){this.activeCategory=e},isSelected:function(e,t){return this.selectedItems.some((function(a){return a.category===e&&a.subCategory===t}))},selectSubcategory:function(e,t){this.isSelected(e,t)||(this.selectedItems.push({category:e,subCategory:t,value:1,factor:this.emissionFactors[e][t]}),this.calculateTotal())},removeItem:function(e){var t=this.selectedItems.findIndex((function(t){return t.category===e.category&&t.subCategory===e.subCategory}));-1!==t&&(this.selectedItems.splice(t,1),this.calculateTotal())},clearAllItems:function(){var e=document.querySelector(".calculation-panel");e&&(e.classList.add("shake-effect"),setTimeout((function(){e.classList.remove("shake-effect")}),500)),this.selectedItems=[],this.calculateTotal()},getUnit:function(e){return this.unitMap[e]||"单位"},getEmissionValue:function(e){var t=(e.factor*e.value).toFixed(1);return t},calculateTotal:function(){var e,t=0,a=(0,q.A)(this.selectedItems);try{for(a.s();!(e=a.n()).done;){var s=e.value;t+=s.factor*s.value}}catch(n){a.e(n)}finally{a.f()}this.totalEmission=t.toFixed(1),this.treesToPlant=(t/28.8*.3).toFixed(1)},getCategoryIcon:function(e,t){var a={衣:"fas fa-tshirt",食:"fas fa-utensils",住:"fas fa-home",行:"fas fa-car",用:"fas fa-shopping-basket"};if(!t)return a[e]||"fas fa-leaf";var s={衣:{涤纶织物:"fas fa-tshirt",纯棉T恤:"fas fa-tshirt",洗衣液:"fas fa-soap"},食:{白酒:"fas fa-wine-bottle",啤酒:"fas fa-beer",吸烟:"fas fa-smoking",羊肉:"fas fa-drumstick-bite",牛肉:"fas fa-hamburger",猪肉:"fas fa-bacon",炸鸡:"fas fa-drumstick-bite",鸡蛋:"fas fa-egg",土豆:"fas fa-seedling",米饭:"fas fa-seedling",花生:"fas fa-seedling",酸奶:"fas fa-wine-glass"},住:{水:"fas fa-water",电:"fas fa-bolt",天然气:"fas fa-fire"},行:{轮船:"fas fa-ship",公交车:"fas fa-bus",私家电车:"fas fa-car",私家油车:"fas fa-car-side",火车:"fas fa-train",飞机:"fas fa-plane"},用:{塑料袋:"fas fa-shopping-bag",纸巾:"fas fa-box-tissue",电子设备:"fas fa-laptop"}};return s[e]&&s[e][t]||"fas fa-leaf"}}};var D=a(71241);const G=(0,D.A)($,[["render",j],["__scopeId","data-v-79181228"]]),Y=G;var Z=a(81387);const ee={components:{Navbar:f.A,CarbonCalculator:Y},setup:function(){var e=(0,Z.rd)(),t=function(){e.push("/carbon-reduction")},a=function(){e.push("/")};return{switchToReductionCalculator:t,goHome:a}}},te=(0,D.A)(ee,[["render",u],["__scopeId","data-v-4c60f5e4"]]),ae=te}}]);
//# sourceMappingURL=637.69a2e001.js.map