{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers, toDisplayString as _toDisplayString, Fragment as _Fragment, createElementBlock as _createElementBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"navbar\"\n};\nvar _hoisted_2 = {\n  \"class\": \"nav-brand\"\n};\nvar _hoisted_3 = {\n  \"class\": \"nav-links\"\n};\nvar _hoisted_4 = {\n  \"class\": \"nav-auth\"\n};\nvar _hoisted_5 = {\n  \"class\": \"username\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"nav\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_router_link, {\n    to: \"/\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[1] || (_cache[1] = [_createElementVNode(\"span\", {\n        \"class\": \"brand-text\"\n      }, \"EcoPaw\", -1 /* HOISTED */)]);\n    }),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_router_link, {\n    to: \"/\",\n    exact: \"\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[2] || (_cache[2] = [_createTextVNode(\"首页\")]);\n    }),\n    _: 1 /* STABLE */\n  }), _createVNode(_component_router_link, {\n    to: \"/calculator\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[3] || (_cache[3] = [_createTextVNode(\"碳计算器\")]);\n    }),\n    _: 1 /* STABLE */\n  }), $data.isLoggedIn ? (_openBlock(), _createBlock(_component_router_link, {\n    key: 0,\n    to: \"/pet\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[4] || (_cache[4] = [_createTextVNode(\"虚拟宠物\")]);\n    }),\n    _: 1 /* STABLE */\n  })) : _createCommentVNode(\"v-if\", true), $data.isLoggedIn ? (_openBlock(), _createBlock(_component_router_link, {\n    key: 1,\n    to: \"/achievements\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[5] || (_cache[5] = [_createTextVNode(\"成就\")]);\n    }),\n    _: 1 /* STABLE */\n  })) : _createCommentVNode(\"v-if\", true), _createVNode(_component_router_link, {\n    to: \"/leaderboard\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[6] || (_cache[6] = [_createTextVNode(\"排行榜\")]);\n    }),\n    _: 1 /* STABLE */\n  }), _createCommentVNode(\" 未登录时显示禁用状态的链接 \"), !$data.isLoggedIn ? (_openBlock(), _createBlock(_component_router_link, {\n    key: 2,\n    to: \"/login\",\n    \"class\": \"disabled-link\",\n    onClick: _withModifiers($options.promptLogin, [\"prevent\"])\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[7] || (_cache[7] = [_createTextVNode(\"虚拟宠物\")]);\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"])) : _createCommentVNode(\"v-if\", true), !$data.isLoggedIn ? (_openBlock(), _createBlock(_component_router_link, {\n    key: 3,\n    to: \"/login\",\n    \"class\": \"disabled-link\",\n    onClick: _withModifiers($options.promptLogin, [\"prevent\"])\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[8] || (_cache[8] = [_createTextVNode(\"成就\")]);\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"])) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"div\", _hoisted_4, [$data.isLoggedIn ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 0\n  }, [_createElementVNode(\"span\", _hoisted_5, _toDisplayString($data.username), 1 /* TEXT */), _createElementVNode(\"button\", {\n    \"class\": \"logout-btn\",\n    onClick: _cache[0] || (_cache[0] = function () {\n      return $options.handleLogout && $options.handleLogout.apply($options, arguments);\n    })\n  }, _cache[9] || (_cache[9] = [_createElementVNode(\"span\", {\n    \"class\": \"btn-text\"\n  }, \"退出\", -1 /* HOISTED */)]))], 64 /* STABLE_FRAGMENT */)) : (_openBlock(), _createBlock(_component_router_link, {\n    key: 1,\n    to: \"/login\",\n    \"class\": \"login-btn\",\n    \"active-class\": \"active\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[10] || (_cache[10] = [_createElementVNode(\"span\", {\n        \"class\": \"btn-text\"\n      }, \"登录\", -1 /* HOISTED */)]);\n    }),\n    _: 1 /* STABLE */\n  }))])]);\n}","map":{"version":3,"names":["_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_router_link","to","_withCtx","_cache","_","_hoisted_3","exact","_createTextVNode","$data","isLoggedIn","_createBlock","key","_createCommentVNode","onClick","_withModifiers","$options","promptLogin","_hoisted_4","_Fragment","_hoisted_5","_toDisplayString","username","handleLogout","apply","arguments"],"sources":["D:\\computer_design\\src\\components\\Navbar.vue"],"sourcesContent":["<template>\r\n  <nav class=\"navbar\">\r\n    <div class=\"nav-brand\">\r\n      <router-link to=\"/\">\r\n        <span class=\"brand-text\">EcoPaw</span>\r\n      </router-link>\r\n    </div>\r\n    <div class=\"nav-links\">\r\n      <router-link to=\"/\" exact>首页</router-link>\r\n      <router-link to=\"/calculator\">碳计算器</router-link>\r\n      <router-link to=\"/pet\" v-if=\"isLoggedIn\">虚拟宠物</router-link>\r\n      <router-link to=\"/achievements\" v-if=\"isLoggedIn\">成就</router-link>\r\n      <router-link to=\"/leaderboard\">排行榜</router-link>\r\n      <!-- 未登录时显示禁用状态的链接 -->\r\n      <router-link to=\"/login\" class=\"disabled-link\" v-if=\"!isLoggedIn\" @click.native.prevent=\"promptLogin\">虚拟宠物</router-link>\r\n      <router-link to=\"/login\" class=\"disabled-link\" v-if=\"!isLoggedIn\" @click.native.prevent=\"promptLogin\">成就</router-link>\r\n    </div>\r\n    <div class=\"nav-auth\">\r\n      <template v-if=\"isLoggedIn\">\r\n        <span class=\"username\">{{ username }}</span>\r\n        <button class=\"logout-btn\" @click=\"handleLogout\">\r\n          <span class=\"btn-text\">退出</span>\r\n        </button>\r\n      </template>\r\n      <template v-else>\r\n        <router-link to=\"/login\" class=\"login-btn\" active-class=\"active\">\r\n          <span class=\"btn-text\">登录</span>\r\n        </router-link>\r\n      </template>\r\n    </div>\r\n  </nav>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport { API_URLS, axiosConfig } from '../config/api';\r\n\r\n// 创建 axios 实例\r\nconst api = axios.create(axiosConfig);\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      isLoggedIn: false,\r\n      username: ''\r\n    };\r\n  },\r\n  methods: {\r\n    checkLoginStatus() {\r\n      const token = localStorage.getItem('token');\r\n      const storedUsername = localStorage.getItem('username');\r\n      \r\n      if (token && storedUsername) {\r\n        this.isLoggedIn = true;\r\n        this.username = storedUsername;\r\n      } else {\r\n        this.isLoggedIn = false;\r\n        this.username = '';\r\n      }\r\n    },\r\n    async handleLogout() {\r\n      try {\r\n        // 调用登出 API\r\n        await api.post(API_URLS.logout);\r\n      } catch (error) {\r\n        console.error('Logout error:', error);\r\n      } finally {\r\n        // 清除本地存储\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('username');\r\n        \r\n        // 更新状态\r\n        this.isLoggedIn = false;\r\n        this.username = '';\r\n        \r\n        // 跳转到登录页\r\n        this.$router.push('/login');\r\n      }\r\n    },\r\n    handleStorageChange(event) {\r\n      if (event.key === 'token' || event.key === 'username') {\r\n        this.checkLoginStatus();\r\n      }\r\n    },\r\n    promptLogin() {\r\n      // 提示用户登录\r\n      this.$router.push('/login');\r\n    }\r\n  },\r\n  created() {\r\n    this.checkLoginStatus();\r\n    window.addEventListener('storage', this.handleStorageChange);\r\n  },\r\n  mounted() {\r\n    // 页面加载时也检查一次登录状态\r\n    this.checkLoginStatus();\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener('storage', this.handleStorageChange);\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.navbar {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 1rem 2rem;\r\n  background-color: #ffffff;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  z-index: 1000;\r\n  height: 64px;\r\n}\r\n\r\n.nav-brand a {\r\n  text-decoration: none;\r\n}\r\n\r\n.brand-text {\r\n  font-size: 1.5rem;\r\n  font-weight: bold;\r\n  color: #4CAF50;\r\n  letter-spacing: 0.5px;\r\n}\r\n\r\n.nav-links {\r\n  display: flex;\r\n  gap: 2rem;\r\n  align-items: center;\r\n}\r\n\r\n.nav-links a {\r\n  color: #333;\r\n  text-decoration: none;\r\n  padding: 0.5rem 1rem;\r\n  border-radius: 4px;\r\n  transition: all 0.3s ease;\r\n  font-size: 1rem;\r\n}\r\n\r\n.nav-links a:hover:not(.disabled-link) {\r\n  background-color: #f0f0f0;\r\n  color: #4CAF50;\r\n}\r\n\r\n.nav-links a.router-link-active:not(.disabled-link) {\r\n  color: #4CAF50;\r\n  font-weight: bold;\r\n}\r\n\r\n.disabled-link {\r\n  color: #999 !important;\r\n  cursor: not-allowed;\r\n  pointer-events: auto !important;\r\n}\r\n\r\n.nav-auth {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1rem;\r\n}\r\n\r\n.username {\r\n  color: #666;\r\n  font-size: 1rem;\r\n  margin-right: 0.5rem;\r\n}\r\n\r\n.login-btn, .logout-btn {\r\n  padding: 0.5rem 1.5rem;\r\n  border: none;\r\n  border-radius: 4px;\r\n  background-color: #4CAF50;\r\n  color: white;\r\n  cursor: pointer;\r\n  text-decoration: none;\r\n  transition: all 0.3s ease;\r\n  font-size: 1rem;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.login-btn:hover, .logout-btn:hover {\r\n  background-color: #45a049;\r\n  transform: translateY(-1px);\r\n}\r\n\r\n.login-btn:active, .logout-btn:active {\r\n  transform: translateY(0);\r\n}\r\n\r\n.btn-text {\r\n  margin: 0 0.25rem;\r\n}\r\n\r\n/* 添加响应式样式 */\r\n@media (max-width: 768px) {\r\n  .nav-links {\r\n    gap: 1rem;\r\n  }\r\n  \r\n  .nav-links a {\r\n    padding: 0.5rem;\r\n  }\r\n  \r\n  .username {\r\n    display: none;\r\n  }\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}