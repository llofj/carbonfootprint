{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/ASUS/Desktop/carbonfootprint/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/ASUS/Desktop/carbonfootprint/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.date.to-string.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.string.search.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.url-search-params.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport axios from 'axios';\nimport { API_URLS, axiosConfig, requestInterceptor, responseInterceptor } from '../config/api';\n\n// 创建API实例\nvar api = axios.create(axiosConfig);\n\n// 添加请求拦截器\napi.interceptors.request.use(requestInterceptor, function (error) {\n  return Promise.reject(error);\n});\n\n// 添加响应拦截器\napi.interceptors.response.use(responseInterceptor.success, responseInterceptor.error);\n\n// 获取API基础URL\nvar getBaseUrl = function getBaseUrl() {\n  var host = window.location.hostname;\n  var port = '5000';\n  var protocol = window.location.protocol;\n  if (host === 'localhost' || host === '127.0.0.1') {\n    return \"http://localhost:\".concat(port, \"/api\");\n  } else {\n    return \"\".concat(protocol, \"//\").concat(host, \":\").concat(port, \"/api\");\n  }\n};\nexport default {\n  data: function data() {\n    return {\n      activeTab: 'carbon',\n      leaderboard: [],\n      userRank: null,\n      username: '',\n      limit: 100,\n      currentPage: 1,\n      pageSize: 10,\n      loading: false,\n      errorMessage: '',\n      apiBaseUrl: getBaseUrl(),\n      totalUserCount: 200,\n      // 估计的用户总数，可以从后端获取\n      isNewUser: false,\n      registrationDate: null,\n      currentUserRank: null,\n      currentUserCarbonReduction: null,\n      currentUserPetLevel: null\n    };\n  },\n  computed: {\n    totalPages: function totalPages() {\n      return Math.ceil(this.leaderboard.length / this.pageSize);\n    },\n    displayedLeaderboard: function displayedLeaderboard() {\n      var start = (this.currentPage - 1) * this.pageSize;\n      var end = start + this.pageSize;\n      return this.leaderboard.slice(start, end);\n    }\n  },\n  created: function created() {\n    var _this = this;\n    return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var token, userResponse, thirtyDaysAgo, urlParams, rankParam, reductionParam;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            console.log('API基础URL:', _this.apiBaseUrl);\n            token = localStorage.getItem('token');\n            if (token) {\n              _context.next = 6;\n              break;\n            }\n            _this.$router.push('/login');\n            return _context.abrupt(\"return\");\n          case 6:\n            _context.next = 8;\n            return axios.get(\"\".concat(_this.apiBaseUrl, \"/auth/user\"), {\n              headers: {\n                Authorization: \"Bearer \".concat(token)\n              }\n            });\n          case 8:\n            userResponse = _context.sent;\n            if (userResponse.data && userResponse.data.username) {\n              _this.username = userResponse.data.username;\n              console.log('成功获取用户信息:', _this.username);\n            } else {\n              console.error('未能获取到用户名:', userResponse.data);\n              _this.username = localStorage.getItem('username') || '';\n            }\n            if (userResponse.data.created_at) {\n              _this.registrationDate = new Date(userResponse.data.created_at);\n              thirtyDaysAgo = new Date();\n              thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n              _this.isNewUser = _this.registrationDate > thirtyDaysAgo;\n            }\n\n            // 尝试从URL参数获取排名信息\n            urlParams = new URLSearchParams(window.location.search);\n            rankParam = urlParams.get('rank');\n            reductionParam = urlParams.get('reduction');\n            if (rankParam) {\n              _this.currentUserRank = rankParam;\n            }\n            if (reductionParam) {\n              _this.currentUserCarbonReduction = reductionParam;\n            }\n\n            // 加载排行榜数据\n            _context.next = 18;\n            return _this.loadLeaderboard();\n          case 18:\n            // 如果排行榜加载成功但还没有用户名，尝试从排行榜数据中获取\n            if (!_this.username && _this.userRank) {\n              _this.username = _this.userRank.username;\n            }\n            _context.next = 26;\n            break;\n          case 21:\n            _context.prev = 21;\n            _context.t0 = _context[\"catch\"](0);\n            console.error('Error loading user data:', _context.t0);\n            // 如果API调用失败，尝试从localStorage获取用户名\n            _this.username = localStorage.getItem('username') || '';\n            _this.handleError(_context.t0, '加载用户数据失败');\n          case 26:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[0, 21]]);\n    }))();\n  },\n  methods: {\n    // 获取用户名的首字母作为头像\n    getInitials: function getInitials(name) {\n      if (!name) return '?';\n\n      // 对于双字节字符（如中文），只取第一个字符\n      if (name.charCodeAt(0) > 127) {\n        return name.charAt(0);\n      }\n\n      // 对于英文等单字节字符，取首字母\n      return name.charAt(0).toUpperCase();\n    },\n    // 获取排名描述\n    getRankDescription: function getRankDescription(rank) {\n      if (rank <= 10) return '优秀减排者';\n      if (rank <= 50) return '活跃减排者';\n      if (rank <= 100) return '进步减排者';\n      return '环保新手';\n    },\n    // 获取百分比\n    getPercentile: function getPercentile(rank) {\n      // 计算击败了多少百分比的用户\n      // 例如：如果总用户数是200，当前排名是20，则击败了(200-20)/200 * 100 = 90%的用户\n      var percentile = Math.floor((this.totalUserCount - rank) / this.totalUserCount * 100);\n      return Math.max(0, Math.min(99, percentile));\n    },\n    // 获取排名图标类\n    getRankIconClass: function getRankIconClass(rank) {\n      if (rank <= 3) return 'text-gold';\n      if (rank <= 10) return 'text-silver';\n      if (rank <= 50) return 'text-bronze';\n      return 'text-normal';\n    },\n    // 获取排名颜色类\n    getRankColorClass: function getRankColorClass(rank) {\n      if (rank <= 3) return 'rank-top';\n      if (rank <= 10) return 'rank-excellent';\n      if (rank <= 50) return 'rank-good';\n      return 'rank-normal';\n    },\n    // 处理错误的通用方法\n    handleError: function handleError(error, defaultMessage) {\n      var errorMsg = defaultMessage;\n      if (error.response && error.response.data && error.response.data.message) {\n        errorMsg = error.response.data.message;\n      } else if (error.message) {\n        errorMsg = \"\".concat(defaultMessage, \": \").concat(error.message);\n      }\n      this.errorMessage = errorMsg;\n      console.error(errorMsg, error);\n    },\n    loadLeaderboard: function loadLeaderboard() {\n      var _this2 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var token, endpoint, response;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _this2.loading = true;\n              _this2.errorMessage = '';\n              token = localStorage.getItem('token');\n              if (token) {\n                _context2.next = 7;\n                break;\n              }\n              _this2.$router.push('/login');\n              return _context2.abrupt(\"return\");\n            case 7:\n              console.log('正在加载排行榜数据，类型:', _this2.activeTab, '限制:', _this2.limit);\n              endpoint = _this2.activeTab === 'carbon' ? 'leaderboard' : 'leaderboard/pet';\n              _context2.next = 11;\n              return axios.get(\"\".concat(_this2.apiBaseUrl, \"/\").concat(endpoint, \"?limit=\").concat(_this2.limit), {\n                headers: {\n                  Authorization: \"Bearer \".concat(token),\n                  'Content-Type': 'application/json'\n                }\n              });\n            case 11:\n              response = _context2.sent;\n              console.log('排行榜数据:', response.data);\n              if (!(response.data && response.data.leaderboard)) {\n                _context2.next = 25;\n                break;\n              }\n              _this2.leaderboard = response.data.leaderboard;\n              _this2.userRank = response.data.userRank;\n              if (!(!_this2.userRank || _this2.activeTab === 'carbon' && _this2.userRank.carbon_reduction === 0 || _this2.activeTab === 'pet' && _this2.userRank.pet_level === 0)) {\n                _context2.next = 20;\n                break;\n              }\n              console.log('用户排名数据为空或数值为0，尝试更新...');\n              _context2.next = 20;\n              return _this2.forceUpdateUserRank();\n            case 20:\n              _this2.leaderboard.sort(function (a, b) {\n                return a.rank - b.rank;\n              });\n              if (response.data.totalUserCount) {\n                _this2.totalUserCount = response.data.totalUserCount;\n                console.log('获取到总用户数:', _this2.totalUserCount);\n              }\n              _this2.currentPage = 1;\n              _context2.next = 28;\n              break;\n            case 25:\n              console.error('返回的数据格式不正确:', response.data);\n              _this2.errorMessage = '返回数据格式不正确，请稍后再试';\n              _this2.leaderboard = [];\n            case 28:\n              _context2.next = 34;\n              break;\n            case 30:\n              _context2.prev = 30;\n              _context2.t0 = _context2[\"catch\"](0);\n              _this2.handleError(_context2.t0, '加载排行榜失败');\n              _this2.leaderboard = [];\n            case 34:\n              _context2.prev = 34;\n              _this2.loading = false;\n              return _context2.finish(34);\n            case 37:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[0, 30, 34, 37]]);\n      }))();\n    },\n    // 强制更新当前用户排名\n    forceUpdateUserRank: function forceUpdateUserRank() {\n      var _this3 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var token, response, userRankResponse;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              token = localStorage.getItem('token');\n              if (token) {\n                _context3.next = 4;\n                break;\n              }\n              return _context3.abrupt(\"return\");\n            case 4:\n              console.log('强制更新当前用户排名...');\n\n              // 调用更新接口\n              _context3.next = 7;\n              return axios.post(\"\".concat(_this3.apiBaseUrl, \"/leaderboard/update\"), {}, {\n                headers: {\n                  Authorization: \"Bearer \".concat(token),\n                  'Content-Type': 'application/json'\n                }\n              });\n            case 7:\n              response = _context3.sent;\n              console.log('排名更新响应:', response.data);\n\n              // 获取最新的用户排名\n              _context3.next = 11;\n              return axios.get(\"\".concat(_this3.apiBaseUrl, \"/leaderboard/user\"), {\n                headers: {\n                  Authorization: \"Bearer \".concat(token),\n                  'Content-Type': 'application/json'\n                }\n              });\n            case 11:\n              userRankResponse = _context3.sent;\n              if (userRankResponse.data) {\n                console.log('更新后的用户排名:', userRankResponse.data);\n                _this3.userRank = userRankResponse.data;\n              }\n              _context3.next = 18;\n              break;\n            case 15:\n              _context3.prev = 15;\n              _context3.t0 = _context3[\"catch\"](0);\n              console.error('强制更新用户排名失败:', _context3.t0);\n            case 18:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, null, [[0, 15]]);\n      }))();\n    },\n    changePage: function changePage(pageNumber) {\n      if (pageNumber >= 1 && pageNumber <= this.totalPages) {\n        this.currentPage = pageNumber;\n      }\n    },\n    updateLeaderboard: function updateLeaderboard() {\n      var _this4 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var token;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.prev = 0;\n              _this4.loading = true;\n              _this4.errorMessage = '';\n              token = localStorage.getItem('token');\n              if (token) {\n                _context4.next = 7;\n                break;\n              }\n              _this4.$router.push('/login');\n              return _context4.abrupt(\"return\");\n            case 7:\n              _context4.next = 9;\n              return axios.post(\"\".concat(_this4.apiBaseUrl, \"/leaderboard/update\"), {}, {\n                headers: {\n                  Authorization: \"Bearer \".concat(token),\n                  'Content-Type': 'application/json'\n                }\n              });\n            case 9:\n              _context4.next = 11;\n              return _this4.loadLeaderboard();\n            case 11:\n              _this4.errorMessage = '';\n              _context4.next = 17;\n              break;\n            case 14:\n              _context4.prev = 14;\n              _context4.t0 = _context4[\"catch\"](0);\n              _this4.handleError(_context4.t0, '更新排行榜失败');\n            case 17:\n              _context4.prev = 17;\n              _this4.loading = false;\n              return _context4.finish(17);\n            case 20:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, null, [[0, 14, 17, 20]]);\n      }))();\n    },\n    isCurrentUser: function isCurrentUser(userId) {\n      return this.userRank && this.userRank.user_id === userId;\n    },\n    getRankClass: function getRankClass(rank) {\n      if (rank === 1) return 'rank-1';\n      if (rank === 2) return 'rank-2';\n      if (rank === 3) return 'rank-3';\n      return '';\n    },\n    switchTab: function switchTab(tab) {\n      this.activeTab = tab;\n      this.loadLeaderboard();\n    }\n  }\n};","map":{"version":3,"names":["axios","API_URLS","axiosConfig","requestInterceptor","responseInterceptor","api","create","interceptors","request","use","error","Promise","reject","response","success","getBaseUrl","host","window","location","hostname","port","protocol","concat","data","activeTab","leaderboard","userRank","username","limit","currentPage","pageSize","loading","errorMessage","apiBaseUrl","totalUserCount","isNewUser","registrationDate","currentUserRank","currentUserCarbonReduction","currentUserPetLevel","computed","totalPages","Math","ceil","length","displayedLeaderboard","start","end","slice","created","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","token","userResponse","thirtyDaysAgo","urlParams","rankParam","reductionParam","wrap","_callee$","_context","prev","next","console","log","localStorage","getItem","$router","push","abrupt","get","headers","Authorization","sent","created_at","Date","setDate","getDate","URLSearchParams","search","loadLeaderboard","t0","handleError","stop","methods","getInitials","name","charCodeAt","charAt","toUpperCase","getRankDescription","rank","getPercentile","percentile","floor","max","min","getRankIconClass","getRankColorClass","defaultMessage","errorMsg","message","_this2","_callee2","endpoint","_callee2$","_context2","carbon_reduction","pet_level","forceUpdateUserRank","sort","a","b","finish","_this3","_callee3","userRankResponse","_callee3$","_context3","post","changePage","pageNumber","updateLeaderboard","_this4","_callee4","_callee4$","_context4","isCurrentUser","userId","user_id","getRankClass","switchTab","tab"],"sources":["C:\\Users\\ASUS\\Desktop\\carbonfootprint\\src\\components\\Leaderboard.vue"],"sourcesContent":["<template>\r\n  <div class=\"leaderboard-page\">\r\n    <h2 class=\"main-title\">排行榜</h2>\r\n    \r\n    <div class=\"tabs\">\r\n      <button \r\n        :class=\"{ active: activeTab === 'carbon' }\" \r\n        @click=\"switchTab('carbon')\"\r\n      >\r\n        碳减排排行\r\n      </button>\r\n      <button \r\n        :class=\"{ active: activeTab === 'pet' }\" \r\n        @click=\"switchTab('pet')\"\r\n      >\r\n        宠物等级排行\r\n      </button>\r\n    </div>\r\n    \r\n    <div v-if=\"errorMessage\" class=\"error-message\">\r\n      <i class=\"fas fa-exclamation-circle\"></i>\r\n      {{ errorMessage }}\r\n    </div>\r\n    \r\n    <!-- 用户自己的排名信息卡片，更美观的展示 -->\r\n    <div class=\"user-rank-card\">\r\n      <div class=\"user-rank-header\">\r\n        <div class=\"user-avatar\">\r\n          <span v-if=\"username\">{{ getInitials(username) }}</span>\r\n          <span v-else><i class=\"fas fa-user\"></i></span>\r\n        </div>\r\n        <div class=\"user-info\">\r\n          <h3>{{ username || '未能获取用户名' }}</h3>\r\n          <div class=\"user-status\">\r\n            {{ activeTab === 'carbon' ? '您当前的碳减排状态' : '您当前的宠物状态' }}\r\n          </div>\r\n          <div class=\"user-badges\" v-if=\"userRank\">\r\n            <span v-if=\"userRank.rank <= 3\" class=\"badge top-badge\" title=\"排名前三\">\r\n              <i class=\"fas fa-crown\"></i>\r\n            </span>\r\n            <span v-if=\"activeTab === 'carbon' && userRank.carbon_reduction >= 100\" class=\"badge century-badge\" title=\"减排量超过100kg\">\r\n              <i class=\"fas fa-medal\"></i>\r\n            </span>\r\n            <span v-if=\"activeTab === 'pet' && userRank.pet_level >= 10\" class=\"badge progress-badge\" title=\"宠物等级达到10级\">\r\n              <i class=\"fas fa-award\"></i>\r\n            </span>\r\n            <span v-if=\"isNewUser\" class=\"badge newcomer-badge\" title=\"新用户\">\r\n              <i class=\"fas fa-seedling\"></i>\r\n            </span>\r\n          </div>\r\n        </div>\r\n        <div v-if=\"userRank\" class=\"rank-badge\" :class=\"getRankColorClass(userRank.rank)\">\r\n          #{{ userRank.rank }}\r\n        </div>\r\n        <div v-else class=\"rank-badge loading-rank\">\r\n          <span>#{{ currentUserRank || '?' }}</span>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"user-stats\">\r\n        <div class=\"stat-item\">\r\n          <div class=\"stat-value\" :class=\"{ 'carbon-value': activeTab === 'carbon' }\">\r\n            <template v-if=\"activeTab === 'carbon'\">\r\n              {{ userRank ? Number(userRank.carbon_reduction).toFixed(1) : (currentUserCarbonReduction || '加载中...') }}\r\n            </template>\r\n            <template v-else>\r\n              {{ userRank ? `Lv.${userRank.pet_level}` : (currentUserPetLevel || '加载中...') }}\r\n            </template>\r\n          </div>\r\n          <div class=\"stat-label\">\r\n            {{ activeTab === 'carbon' ? '减排量 (kg CO₂)' : '宠物等级' }}\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"stat-item\">\r\n          <div class=\"stat-value\">\r\n            <i v-if=\"userRank\" class=\"fas fa-trophy\" :class=\"getRankIconClass(userRank.rank)\"></i>\r\n            <i v-else class=\"fas fa-trophy text-normal\"></i>\r\n          </div>\r\n          <div class=\"stat-label\">{{ userRank ? getRankDescription(userRank.rank) : '活跃用户' }}</div>\r\n        </div>\r\n        \r\n        <div class=\"stat-divider\"></div>\r\n        \r\n        <div class=\"stat-item\">\r\n          <div class=\"stat-value achievement\">\r\n            <span class=\"percentage\">{{ userRank ? getPercentile(userRank.rank) : '81' }}%</span>\r\n          </div>\r\n          <div class=\"stat-label\">击败了其他用户</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    <div class=\"leaderboard-controls\">\r\n      <div class=\"update-section\">\r\n        <button @click=\"updateLeaderboard\" class=\"update-btn\" :disabled=\"loading\">\r\n          <i class=\"fas fa-sync-alt\" :class=\"{ 'fa-spin': loading }\"></i>\r\n          {{ loading ? '更新中...' : '更新排名' }}\r\n        </button>\r\n      </div>\r\n      \r\n      <div class=\"filter-section\">\r\n        <select v-model=\"limit\" @change=\"loadLeaderboard\" class=\"filter-select\">\r\n          <option :value=\"10\">显示10名</option>\r\n          <option :value=\"20\">显示20名</option>\r\n          <option :value=\"50\">显示50名</option>\r\n          <option :value=\"100\">显示100名</option>\r\n        </select>\r\n      </div>\r\n    </div>\r\n    \r\n    <div class=\"leaderboard-container\">\r\n      <div class=\"leaderboard-table\">\r\n        <table>\r\n          <thead>\r\n            <tr>\r\n              <th class=\"rank-cell\">排名</th>\r\n              <th>用户</th>\r\n              <th>{{ activeTab === 'carbon' ? '减排量 (kg CO₂)' : '宠物等级' }}</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"(entry, index) in displayedLeaderboard\" :key=\"index\" \r\n                :class=\"{ 'current-user': isCurrentUser(entry.user_id) }\"\r\n                :style=\"{ '--row-index': index }\">\r\n              <td class=\"rank-cell\">\r\n                <div class=\"rank-number\" :class=\"getRankClass(entry.rank)\">\r\n                  <template v-if=\"entry.rank <= 3\">\r\n                    <span>{{ entry.rank }}</span>\r\n                  </template>\r\n                  <template v-else>\r\n                    {{ entry.rank }}\r\n                  </template>\r\n                </div>\r\n              </td>\r\n              <td>\r\n                <div class=\"user-info-row\">\r\n                  <div class=\"user-avatar-small\" :class=\"{ 'current-user': isCurrentUser(entry.user_id) }\">\r\n                    {{ getInitials(entry.username) }}\r\n                  </div>\r\n                  <span>{{ entry.username }}</span>\r\n                  <span v-if=\"isCurrentUser(entry.user_id)\" class=\"current-user-tag\">当前用户</span>\r\n                </div>\r\n              </td>\r\n              <td>\r\n                <template v-if=\"activeTab === 'carbon'\">\r\n                  {{ Number(entry.carbon_reduction).toFixed(1) }}\r\n                </template>\r\n                <template v-else>\r\n                  Lv.{{ entry.pet_level }} ({{ entry.experience }}经验)\r\n                </template>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n      \r\n      <div v-if=\"leaderboard.length === 0\" class=\"no-data\">\r\n        暂无排行数据\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- 分页控件 -->\r\n    <div class=\"pagination\" v-if=\"leaderboard.length > 0\">\r\n      <button \r\n        @click=\"changePage(currentPage - 1)\" \r\n        :disabled=\"currentPage === 1\"\r\n        class=\"pagination-btn\"\r\n      >\r\n        <i class=\"fas fa-chevron-left\"></i>\r\n      </button>\r\n      \r\n      <div class=\"page-info\">\r\n        第 {{ currentPage }} 页 / 共 {{ totalPages }} 页\r\n      </div>\r\n      \r\n      <button \r\n        @click=\"changePage(currentPage + 1)\" \r\n        :disabled=\"currentPage === totalPages\"\r\n        class=\"pagination-btn\"\r\n      >\r\n        <i class=\"fas fa-chevron-right\"></i>\r\n      </button>\r\n    </div>\r\n    \r\n    <div class=\"total-entries\" v-if=\"leaderboard.length > 0\">\r\n      展示第 {{ (currentPage - 1) * pageSize + 1 }} - {{ Math.min(currentPage * pageSize, leaderboard.length) }} 条，\r\n      共 {{ leaderboard.length }} 条记录\r\n    </div>\r\n    \r\n    <div class=\"leaderboard-tips\">\r\n      <h3>如何提高排名?</h3>\r\n      <ul>\r\n        <template v-if=\"activeTab === 'carbon'\">\r\n          <li><i class=\"fas fa-walking\"></i> 多步行减少碳排放</li>\r\n          <li><i class=\"fas fa-calculator\"></i> 通过碳排放计算器记录您的低碳行为</li>\r\n          <li><i class=\"fas fa-paw\"></i> 喂养并升级您的虚拟宠物</li>\r\n          <li><i class=\"fas fa-award\"></i> 完成成就任务获得额外奖励</li>\r\n        </template>\r\n        <template v-else>\r\n          <li><i class=\"fas fa-dumbbell\"></i> 定期训练您的宠物</li>\r\n          <li><i class=\"fas fa-coins\"></i> 积累足够的金币进行升级</li>\r\n          <li><i class=\"fas fa-heart\"></i> 保持宠物健康状态</li>\r\n          <li><i class=\"fas fa-star\"></i> 完成每日任务获得经验值</li>\r\n        </template>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport { API_URLS, axiosConfig, requestInterceptor, responseInterceptor } from '../config/api';\r\n\r\n// 创建API实例\r\nconst api = axios.create(axiosConfig);\r\n\r\n// 添加请求拦截器\r\napi.interceptors.request.use(requestInterceptor, error => Promise.reject(error));\r\n\r\n// 添加响应拦截器\r\napi.interceptors.response.use(\r\n  responseInterceptor.success, \r\n  responseInterceptor.error\r\n);\r\n\r\n// 获取API基础URL\r\nconst getBaseUrl = () => {\r\n  const host = window.location.hostname;\r\n  const port = '5000';\r\n  const protocol = window.location.protocol;\r\n  \r\n  if (host === 'localhost' || host === '127.0.0.1') {\r\n    return `http://localhost:${port}/api`;\r\n  } else {\r\n    return `${protocol}//${host}:${port}/api`;\r\n  }\r\n};\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      activeTab: 'carbon',\r\n      leaderboard: [],\r\n      userRank: null,\r\n      username: '',\r\n      limit: 100,\r\n      currentPage: 1,\r\n      pageSize: 10,\r\n      loading: false,\r\n      errorMessage: '',\r\n      apiBaseUrl: getBaseUrl(),\r\n      totalUserCount: 200, // 估计的用户总数，可以从后端获取\r\n      isNewUser: false,\r\n      registrationDate: null,\r\n      currentUserRank: null,\r\n      currentUserCarbonReduction: null,\r\n      currentUserPetLevel: null\r\n    };\r\n  },\r\n  computed: {\r\n    totalPages() {\r\n      return Math.ceil(this.leaderboard.length / this.pageSize);\r\n    },\r\n    displayedLeaderboard() {\r\n      const start = (this.currentPage - 1) * this.pageSize;\r\n      const end = start + this.pageSize;\r\n      return this.leaderboard.slice(start, end);\r\n    }\r\n  },\r\n  async created() {\r\n    try {\r\n      console.log('API基础URL:', this.apiBaseUrl);\r\n      \r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        this.$router.push('/login');\r\n        return;\r\n      }\r\n      \r\n      // 获取用户信息\r\n      const userResponse = await axios.get(`${this.apiBaseUrl}/auth/user`, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      \r\n      if (userResponse.data && userResponse.data.username) {\r\n        this.username = userResponse.data.username;\r\n        console.log('成功获取用户信息:', this.username);\r\n      } else {\r\n        console.error('未能获取到用户名:', userResponse.data);\r\n        this.username = localStorage.getItem('username') || '';\r\n      }\r\n\r\n      if (userResponse.data.created_at) {\r\n        this.registrationDate = new Date(userResponse.data.created_at);\r\n        const thirtyDaysAgo = new Date();\r\n        thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\r\n        this.isNewUser = this.registrationDate > thirtyDaysAgo;\r\n      }\r\n      \r\n      // 尝试从URL参数获取排名信息\r\n      const urlParams = new URLSearchParams(window.location.search);\r\n      const rankParam = urlParams.get('rank');\r\n      const reductionParam = urlParams.get('reduction');\r\n      \r\n      if (rankParam) {\r\n        this.currentUserRank = rankParam;\r\n      }\r\n      \r\n      if (reductionParam) {\r\n        this.currentUserCarbonReduction = reductionParam;\r\n      }\r\n      \r\n      // 加载排行榜数据\r\n      await this.loadLeaderboard();\r\n\r\n      // 如果排行榜加载成功但还没有用户名，尝试从排行榜数据中获取\r\n      if (!this.username && this.userRank) {\r\n        this.username = this.userRank.username;\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading user data:', error);\r\n      // 如果API调用失败，尝试从localStorage获取用户名\r\n      this.username = localStorage.getItem('username') || '';\r\n      this.handleError(error, '加载用户数据失败');\r\n    }\r\n  },\r\n  methods: {\r\n    // 获取用户名的首字母作为头像\r\n    getInitials(name) {\r\n      if (!name) return '?';\r\n      \r\n      // 对于双字节字符（如中文），只取第一个字符\r\n      if (name.charCodeAt(0) > 127) {\r\n        return name.charAt(0);\r\n      }\r\n      \r\n      // 对于英文等单字节字符，取首字母\r\n      return name.charAt(0).toUpperCase();\r\n    },\r\n    \r\n    // 获取排名描述\r\n    getRankDescription(rank) {\r\n      if (rank <= 10) return '优秀减排者';\r\n      if (rank <= 50) return '活跃减排者';\r\n      if (rank <= 100) return '进步减排者';\r\n      return '环保新手';\r\n    },\r\n    \r\n    // 获取百分比\r\n    getPercentile(rank) {\r\n      // 计算击败了多少百分比的用户\r\n      // 例如：如果总用户数是200，当前排名是20，则击败了(200-20)/200 * 100 = 90%的用户\r\n      const percentile = Math.floor(((this.totalUserCount - rank) / this.totalUserCount) * 100);\r\n      return Math.max(0, Math.min(99, percentile));\r\n    },\r\n    \r\n    // 获取排名图标类\r\n    getRankIconClass(rank) {\r\n      if (rank <= 3) return 'text-gold';\r\n      if (rank <= 10) return 'text-silver';\r\n      if (rank <= 50) return 'text-bronze';\r\n      return 'text-normal';\r\n    },\r\n    \r\n    // 获取排名颜色类\r\n    getRankColorClass(rank) {\r\n      if (rank <= 3) return 'rank-top';\r\n      if (rank <= 10) return 'rank-excellent';\r\n      if (rank <= 50) return 'rank-good';\r\n      return 'rank-normal';\r\n    },\r\n    \r\n    // 处理错误的通用方法\r\n    handleError(error, defaultMessage) {\r\n      let errorMsg = defaultMessage;\r\n      \r\n      if (error.response && error.response.data && error.response.data.message) {\r\n        errorMsg = error.response.data.message;\r\n      } else if (error.message) {\r\n        errorMsg = `${defaultMessage}: ${error.message}`;\r\n      }\r\n      \r\n      this.errorMessage = errorMsg;\r\n      console.error(errorMsg, error);\r\n    },\r\n    \r\n    async loadLeaderboard() {\r\n      try {\r\n        this.loading = true;\r\n        this.errorMessage = '';\r\n        \r\n        const token = localStorage.getItem('token');\r\n        if (!token) {\r\n          this.$router.push('/login');\r\n          return;\r\n        }\r\n        \r\n        console.log('正在加载排行榜数据，类型:', this.activeTab, '限制:', this.limit);\r\n        \r\n        const endpoint = this.activeTab === 'carbon' ? 'leaderboard' : 'leaderboard/pet';\r\n        const response = await axios.get(`${this.apiBaseUrl}/${endpoint}?limit=${this.limit}`, {\r\n          headers: { \r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'application/json'\r\n          }\r\n        });\r\n        \r\n        console.log('排行榜数据:', response.data);\r\n        \r\n        if (response.data && response.data.leaderboard) {\r\n          this.leaderboard = response.data.leaderboard;\r\n          this.userRank = response.data.userRank;\r\n          \r\n          if (!this.userRank || \r\n              (this.activeTab === 'carbon' && this.userRank.carbon_reduction === 0) ||\r\n              (this.activeTab === 'pet' && this.userRank.pet_level === 0)) {\r\n            console.log('用户排名数据为空或数值为0，尝试更新...');\r\n            await this.forceUpdateUserRank();\r\n          }\r\n          \r\n          this.leaderboard.sort((a, b) => a.rank - b.rank);\r\n          \r\n          if (response.data.totalUserCount) {\r\n            this.totalUserCount = response.data.totalUserCount;\r\n            console.log('获取到总用户数:', this.totalUserCount);\r\n          }\r\n          \r\n          this.currentPage = 1;\r\n        } else {\r\n          console.error('返回的数据格式不正确:', response.data);\r\n          this.errorMessage = '返回数据格式不正确，请稍后再试';\r\n          this.leaderboard = [];\r\n        }\r\n      } catch (error) {\r\n        this.handleError(error, '加载排行榜失败');\r\n        this.leaderboard = [];\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    \r\n    // 强制更新当前用户排名\r\n    async forceUpdateUserRank() {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        if (!token) return;\r\n        \r\n        console.log('强制更新当前用户排名...');\r\n        \r\n        // 调用更新接口\r\n        const response = await axios.post(`${this.apiBaseUrl}/leaderboard/update`, {}, {\r\n          headers: { \r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'application/json' \r\n          }\r\n        });\r\n        \r\n        console.log('排名更新响应:', response.data);\r\n        \r\n        // 获取最新的用户排名\r\n        const userRankResponse = await axios.get(`${this.apiBaseUrl}/leaderboard/user`, {\r\n          headers: { \r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'application/json'\r\n          }\r\n        });\r\n        \r\n        if (userRankResponse.data) {\r\n          console.log('更新后的用户排名:', userRankResponse.data);\r\n          this.userRank = userRankResponse.data;\r\n        }\r\n      } catch (error) {\r\n        console.error('强制更新用户排名失败:', error);\r\n      }\r\n    },\r\n    \r\n    changePage(pageNumber) {\r\n      if (pageNumber >= 1 && pageNumber <= this.totalPages) {\r\n        this.currentPage = pageNumber;\r\n      }\r\n    },\r\n    \r\n    async updateLeaderboard() {\r\n      try {\r\n        this.loading = true;\r\n        this.errorMessage = '';\r\n        \r\n        const token = localStorage.getItem('token');\r\n        if (!token) {\r\n          this.$router.push('/login');\r\n          return;\r\n        }\r\n        \r\n        // 直接使用axios\r\n        await axios.post(`${this.apiBaseUrl}/leaderboard/update`, {}, {\r\n          headers: { \r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'application/json' \r\n          }\r\n        });\r\n        \r\n        await this.loadLeaderboard();\r\n        this.errorMessage = '';\r\n      } catch (error) {\r\n        this.handleError(error, '更新排行榜失败');\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    \r\n    isCurrentUser(userId) {\r\n      return this.userRank && this.userRank.user_id === userId;\r\n    },\r\n    \r\n    getRankClass(rank) {\r\n      if (rank === 1) return 'rank-1';\r\n      if (rank === 2) return 'rank-2';\r\n      if (rank === 3) return 'rank-3';\r\n      return '';\r\n    },\r\n    \r\n    switchTab(tab) {\r\n      this.activeTab = tab;\r\n      this.loadLeaderboard();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.leaderboard-page {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n  padding: 20px;\r\n  font-family: 'Arial', sans-serif;\r\n}\r\n\r\n.main-title {\r\n  text-align: center;\r\n  color: #2196F3;\r\n  margin-bottom: 20px;\r\n  font-size: 1.8rem;\r\n}\r\n\r\n.user-rank-card {\r\n  background: linear-gradient(135deg, #bbdefb 0%, #e3f2fd 100%);\r\n  border-radius: 12px;\r\n  overflow: hidden;\r\n  margin-bottom: 25px;\r\n  box-shadow: 0 4px 12px rgba(0,0,0,0.1);\r\n  border: 1px solid rgba(0,0,0,0.05);\r\n  animation: slideInFromTop 0.8s ease-out;\r\n  width: 100%;\r\n  max-width: 800px;\r\n}\r\n\r\n@keyframes slideInFromTop {\r\n  0% {\r\n    opacity: 0;\r\n    transform: translateY(-30px);\r\n  }\r\n  100% {\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n  }\r\n}\r\n\r\n.user-rank-header {\r\n  padding: 25px;\r\n  display: flex;\r\n  align-items: center;\r\n  border-bottom: 1px solid rgba(0,0,0,0.05);\r\n  background-color: rgba(255, 255, 255, 0.3);\r\n}\r\n\r\n.user-avatar {\r\n  width: 80px;\r\n  height: 80px;\r\n  border-radius: 50%;\r\n  background: linear-gradient(135deg, #2196F3, #03A9F4);\r\n  color: white;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 2.2rem;\r\n  font-weight: bold;\r\n  margin-right: 20px;\r\n  box-shadow: 0 4px 10px rgba(33,150,243,0.4);\r\n  text-transform: uppercase;\r\n  position: relative;\r\n  overflow: hidden;\r\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\r\n  animation: pulse 2s infinite;\r\n}\r\n\r\n.user-avatar:hover {\r\n  transform: scale(1.05);\r\n  box-shadow: 0 6px 15px rgba(33,150,243,0.6);\r\n}\r\n\r\n@keyframes pulse {\r\n  0% {\r\n    box-shadow: 0 4px 10px rgba(33,150,243,0.4);\r\n  }\r\n  50% {\r\n    box-shadow: 0 4px 20px rgba(33,150,243,0.6);\r\n  }\r\n  100% {\r\n    box-shadow: 0 4px 10px rgba(33,150,243,0.4);\r\n  }\r\n}\r\n\r\n.badge {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 24px;\r\n  height: 24px;\r\n  border-radius: 50%;\r\n  font-size: 0.8rem;\r\n  color: white;\r\n  cursor: help;\r\n  box-shadow: 0 2px 4px rgba(0,0,0,0.2);\r\n  transition: transform 0.2s ease, box-shadow 0.2s ease;\r\n  animation: badgePop 0.5s ease-out;\r\n}\r\n\r\n.badge:hover {\r\n  transform: translateY(-2px) rotate(10deg);\r\n  box-shadow: 0 4px 8px rgba(0,0,0,0.3);\r\n}\r\n\r\n@keyframes badgePop {\r\n  0% {\r\n    transform: scale(0);\r\n  }\r\n  70% {\r\n    transform: scale(1.2);\r\n  }\r\n  100% {\r\n    transform: scale(1);\r\n  }\r\n}\r\n\r\n.rank-1, .rank-2, .rank-3 {\r\n  width: 32px;\r\n  height: 32px;\r\n  border-radius: 50%;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: white;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);\r\n  animation: rankPulse 1.5s infinite alternate;\r\n}\r\n\r\n@keyframes rankPulse {\r\n  0% {\r\n    transform: scale(1);\r\n  }\r\n  100% {\r\n    transform: scale(1.1);\r\n  }\r\n}\r\n\r\n.tip-card {\r\n  display: flex;\r\n  background-color: #F6F8FA;\r\n  border-radius: 10px;\r\n  padding: 15px;\r\n  transition: transform 0.2s ease, box-shadow 0.2s ease;\r\n  animation: cardAppear 0.5s ease-out;\r\n  animation-fill-mode: both;\r\n  animation-delay: calc(var(--index, 0) * 0.1s);\r\n}\r\n\r\n@keyframes cardAppear {\r\n  0% {\r\n    opacity: 0;\r\n    transform: translateY(20px);\r\n  }\r\n  100% {\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n  }\r\n}\r\n\r\n.user-info {\r\n  flex: 1;\r\n}\r\n\r\n.user-info h3 {\r\n  margin: 0 0 8px 0;\r\n  font-size: 1.5rem;\r\n  color: #333;\r\n  font-weight: 600;\r\n}\r\n\r\n.user-status {\r\n  color: #555;\r\n  font-size: 0.95rem;\r\n  margin-bottom: 6px;\r\n}\r\n\r\n.user-badges {\r\n  display: flex;\r\n  gap: 5px;\r\n}\r\n\r\n.rank-badge {\r\n  font-size: 1.8rem;\r\n  font-weight: bold;\r\n  padding: 12px 20px;\r\n  border-radius: 10px;\r\n  color: white;\r\n  box-shadow: 0 4px 10px rgba(0,0,0,0.15);\r\n}\r\n\r\n.rank-top {\r\n  background-color: #F57C00;\r\n}\r\n\r\n.rank-excellent {\r\n  background-color: #4CAF50;\r\n}\r\n\r\n.rank-good {\r\n  background-color: #2196F3;\r\n}\r\n\r\n.rank-normal {\r\n  background-color: #9E9E9E;\r\n}\r\n\r\n.user-stats {\r\n  display: flex;\r\n  padding: 20px;\r\n  background-color: rgba(255,255,255,0.7);\r\n  justify-content: space-around;\r\n}\r\n\r\n.stat-item {\r\n  flex: 1;\r\n  text-align: center;\r\n  padding: 15px;\r\n}\r\n\r\n.stat-value {\r\n  font-size: 1.7rem;\r\n  font-weight: bold;\r\n  color: #2196F3;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.carbon-value {\r\n  font-size: 2.2rem;\r\n  background: linear-gradient(135deg, #2196F3, #03A9F4);\r\n  -webkit-background-clip: text;\r\n  -webkit-text-fill-color: transparent;\r\n  animation: floatAnimation 4s ease-in-out infinite;\r\n  display: inline-block;\r\n}\r\n\r\n.stat-label {\r\n  font-size: 0.9rem;\r\n  color: #555;\r\n  font-weight: 500;\r\n}\r\n\r\n.stat-divider {\r\n  width: 1px;\r\n  background-color: rgba(0,0,0,0.1);\r\n  margin: 10px 5px;\r\n}\r\n\r\n.text-gold {\r\n  color: #F57C00;\r\n}\r\n\r\n.text-silver {\r\n  color: #607D8B;\r\n}\r\n\r\n.text-bronze {\r\n  color: #795548;\r\n}\r\n\r\n.leaderboard-controls {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 25px;\r\n  background-color: white;\r\n  padding: 15px 20px;\r\n  border-radius: 12px;\r\n  box-shadow: 0 4px 12px rgba(0,0,0,0.05);\r\n}\r\n\r\n.error-message {\r\n  background-color: #ffebee;\r\n  color: #d32f2f;\r\n  padding: 12px;\r\n  border-radius: 8px;\r\n  margin-bottom: 20px;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n}\r\n\r\n.error-message i {\r\n  font-size: 20px;\r\n}\r\n\r\n.update-btn {\r\n  background: linear-gradient(135deg, #2196F3, #03A9F4);\r\n  color: white;\r\n  border: none;\r\n  border-radius: 25px;\r\n  padding: 10px 20px;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 10px;\r\n  transition: all 0.3s;\r\n  font-weight: 500;\r\n  box-shadow: 0 3px 8px rgba(33,150,243,0.3);\r\n  font-size: 0.95rem;\r\n}\r\n\r\n.update-btn:hover:not(:disabled) {\r\n  background: linear-gradient(135deg, #1976D2, #0288D1);\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 5px 12px rgba(33,150,243,0.4);\r\n}\r\n\r\n.filter-select {\r\n  padding: 10px 15px;\r\n  border-radius: 25px;\r\n  border: 1px solid #e0e0e0;\r\n  background-color: white;\r\n  font-size: 0.95rem;\r\n  box-shadow: 0 2px 5px rgba(0,0,0,0.05);\r\n  cursor: pointer;\r\n  min-width: 130px;\r\n  color: #424242;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.filter-select:hover {\r\n  border-color: #2196F3;\r\n  box-shadow: 0 2px 8px rgba(33,150,243,0.2);\r\n}\r\n\r\n.leaderboard-container {\r\n  background-color: white;\r\n  border-radius: 12px;\r\n  overflow: hidden;\r\n  box-shadow: 0 4px 16px rgba(0,0,0,0.1);\r\n  margin-bottom: 25px;\r\n  min-height: 300px;\r\n  position: relative;\r\n  width: 100%;\r\n}\r\n\r\n.leaderboard-table {\r\n  width: 100%;\r\n  border-spacing: 0;\r\n  border-collapse: separate;\r\n  background-color: #fff;\r\n  border-radius: 12px;\r\n  overflow: hidden;\r\n}\r\n\r\n.leaderboard-table table {\r\n  width: 100%;\r\n}\r\n\r\n.leaderboard-table th {\r\n  text-align: left;\r\n  padding: 18px 22px;\r\n  color: #424242;\r\n  font-weight: 600;\r\n  font-size: 0.9rem;\r\n  text-transform: uppercase;\r\n  letter-spacing: 0.5px;\r\n  background-color: #F6F8FA;\r\n  border-bottom: 1px solid #E6EBF1;\r\n}\r\n\r\n.leaderboard-table td {\r\n  padding: 16px 22px;\r\n  border-bottom: 1px solid #E6EBF1;\r\n  color: #24292F;\r\n  font-size: 1rem;\r\n}\r\n\r\n.user-info-row {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12px;\r\n}\r\n\r\n.user-avatar-small {\r\n  width: 36px;\r\n  height: 36px;\r\n  border-radius: 50%;\r\n  background: linear-gradient(135deg, #90CAF9, #64B5F6);\r\n  color: white;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 1rem;\r\n  font-weight: bold;\r\n  text-transform: uppercase;\r\n  flex-shrink: 0;\r\n  box-shadow: 0 3px 6px rgba(0,0,0,0.1);\r\n  transition: transform 0.2s ease;\r\n}\r\n\r\n.user-avatar-small:hover {\r\n  transform: scale(1.1);\r\n}\r\n\r\n.user-avatar-small.current-user {\r\n  background: linear-gradient(135deg, #2196F3, #03A9F4);\r\n  box-shadow: 0 3px 8px rgba(33,150,243,0.4);\r\n}\r\n\r\n.current-user-tag {\r\n  display: inline-block;\r\n  font-size: 0.7rem;\r\n  background: linear-gradient(135deg, #2196F3, #03A9F4);\r\n  color: white;\r\n  padding: 3px 8px;\r\n  border-radius: 12px;\r\n  margin-left: 8px;\r\n  vertical-align: middle;\r\n  font-weight: bold;\r\n  box-shadow: 0 2px 4px rgba(33,150,243,0.3);\r\n}\r\n\r\n.leaderboard-tips {\r\n  background-color: #f5f5f5;\r\n  border-radius: 8px;\r\n  padding: 20px;\r\n  margin-top: 20px;\r\n  box-shadow: 0 2px 4px rgba(0,0,0,0.05);\r\n}\r\n\r\n.leaderboard-tips h3 {\r\n  color: #1976D2;\r\n  margin-top: 0;\r\n  margin-bottom: 15px;\r\n  font-size: 1.2rem;\r\n}\r\n\r\n.leaderboard-tips ul {\r\n  padding-left: 10px;\r\n  margin: 0;\r\n  list-style-type: none;\r\n}\r\n\r\n.leaderboard-tips li {\r\n  margin-bottom: 10px;\r\n  color: #555;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.leaderboard-tips li i {\r\n  color: #2196F3;\r\n  margin-right: 10px;\r\n  width: 20px;\r\n  text-align: center;\r\n}\r\n\r\n/* 分页样式 */\r\n.pagination {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  margin: 25px 0;\r\n  gap: 15px;\r\n}\r\n\r\n.pagination-btn {\r\n  background-color: white;\r\n  border: none;\r\n  width: 40px;\r\n  height: 40px;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n  transition: all 0.3s;\r\n  box-shadow: 0 2px 6px rgba(0,0,0,0.1);\r\n  color: #2196F3;\r\n  font-size: 1rem;\r\n}\r\n\r\n.pagination-btn:hover:not(:disabled) {\r\n  background-color: #2196F3;\r\n  color: white;\r\n  transform: translateY(-2px);\r\n  box-shadow: 0 4px 10px rgba(33,150,243,0.3);\r\n}\r\n\r\n.page-info {\r\n  font-size: 0.9rem;\r\n  color: #666;\r\n}\r\n\r\n.total-entries {\r\n  text-align: center;\r\n  font-size: 0.9rem;\r\n  color: #666;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n@media (max-width: 600px) {\r\n  .leaderboard-controls {\r\n    flex-direction: column;\r\n    align-items: flex-start;\r\n    gap: 10px;\r\n  }\r\n  \r\n  .user-rank-header {\r\n    flex-direction: column;\r\n    text-align: center;\r\n  }\r\n  \r\n  .user-avatar {\r\n    margin-right: 0;\r\n    margin-bottom: 10px;\r\n  }\r\n  \r\n  .rank-badge {\r\n    margin-top: 10px;\r\n  }\r\n  \r\n  .user-stats {\r\n    flex-direction: column;\r\n  }\r\n  \r\n  .stat-divider {\r\n    height: 1px;\r\n    width: 100%;\r\n    margin: 5px 0;\r\n  }\r\n  \r\n  .leaderboard-row {\r\n    padding: 10px;\r\n  }\r\n  \r\n  .rank-number {\r\n    width: 25px;\r\n    height: 25px;\r\n    font-size: 0.9rem;\r\n  }\r\n  \r\n  .user-column {\r\n    font-size: 0.9rem;\r\n  }\r\n  \r\n  .reduction-column {\r\n    width: 100px;\r\n    font-size: 0.9rem;\r\n  }\r\n}\r\n\r\n.achievement {\r\n  position: relative;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.percentage {\r\n  font-weight: bold;\r\n  color: #ff9800;\r\n  text-shadow: 0 1px 2px rgba(0,0,0,0.1);\r\n}\r\n\r\n.achievement:after {\r\n  content: '';\r\n  position: absolute;\r\n  width: 110%;\r\n  height: 5px;\r\n  bottom: -4px;\r\n  left: -5%;\r\n  background: linear-gradient(90deg, #ff9800, #ffeb3b);\r\n  border-radius: 3px;\r\n}\r\n\r\n.rank-cell {\r\n  width: 50px;\r\n  font-weight: 600;\r\n}\r\n\r\n.top-rank {\r\n  font-weight: 700;\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.rank-1, .rank-2, .rank-3 {\r\n  width: 32px;\r\n  height: 32px;\r\n  border-radius: 50%;\r\n  display: inline-flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: white;\r\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.rank-1 {\r\n  background: linear-gradient(135deg, #FFD700, #FFA500);\r\n}\r\n\r\n.rank-2 {\r\n  background: linear-gradient(135deg, #E0E0E0, #B0B0B0);\r\n}\r\n\r\n.rank-3 {\r\n  background: linear-gradient(135deg, #CD7F32, #8B4513);\r\n}\r\n\r\n.user-column {\r\n  flex: 1;\r\n  padding: 0 10px;\r\n  position: relative;\r\n}\r\n\r\n.update-btn i.fa-spin {\r\n  animation: spin 1s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n  100% {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n\r\n@keyframes floatAnimation {\r\n  0% {\r\n    transform: translateY(0);\r\n  }\r\n  50% {\r\n    transform: translateY(-8px);\r\n  }\r\n  100% {\r\n    transform: translateY(0);\r\n  }\r\n}\r\n\r\n.leaderboard-table tr {\r\n  transition: background-color 0.15s ease;\r\n  animation: fadeIn 0.5s ease-out;\r\n  animation-fill-mode: both;\r\n  animation-delay: calc(var(--row-index, 0) * 0.1s);\r\n}\r\n\r\n@keyframes fadeIn {\r\n  from {\r\n    opacity: 0;\r\n    transform: translateY(10px);\r\n  }\r\n  to {\r\n    opacity: 1;\r\n    transform: translateY(0);\r\n  }\r\n}\r\n\r\n.leaderboard-table tr:hover {\r\n  background-color: #F6F8FA;\r\n}\r\n\r\n.leaderboard-table tr.current-user {\r\n  background-color: rgba(33, 150, 243, 0.08);\r\n}\r\n\r\n.leaderboard-table tr.current-user:hover {\r\n  background-color: rgba(33, 150, 243, 0.12);\r\n}\r\n\r\n.leaderboard-table tr:last-child td {\r\n  border-bottom: none;\r\n}\r\n\r\n.no-data {\r\n  padding: 30px;\r\n  text-align: center;\r\n  color: #999;\r\n  font-size: 1.1rem;\r\n}\r\n\r\n.loading-indicator {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  padding: 40px;\r\n  color: #666;\r\n}\r\n\r\n.spinner {\r\n  width: 40px;\r\n  height: 40px;\r\n  border: 4px solid rgba(0, 0, 0, 0.1);\r\n  border-radius: 50%;\r\n  border-top-color: #2196F3;\r\n  animation: spin 1s ease-in-out infinite;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n@keyframes spin {\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n\r\n.pagination-btn:disabled {\r\n  opacity: 0.5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.update-btn:disabled {\r\n  background: linear-gradient(135deg, #90CAF9, #64B5F6);\r\n  cursor: not-allowed;\r\n  box-shadow: none;\r\n}\r\n\r\n.loading-rank {\r\n  background-color: #9E9E9E;\r\n  animation: pulse 1.5s infinite;\r\n}\r\n\r\n.text-normal {\r\n  color: #9E9E9E;\r\n}\r\n\r\n.tabs {\r\n  display: flex;\r\n  justify-content: center;\r\n  gap: 20px;\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.tabs button {\r\n  padding: 10px 20px;\r\n  border: none;\r\n  border-radius: 20px;\r\n  background: #f0f0f0;\r\n  color: #666;\r\n  font-size: 1rem;\r\n  cursor: pointer;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.tabs button.active {\r\n  background: #2196F3;\r\n  color: white;\r\n  box-shadow: 0 2px 4px rgba(33, 150, 243, 0.3);\r\n}\r\n\r\n.tabs button:hover:not(.active) {\r\n  background: #e0e0e0;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}