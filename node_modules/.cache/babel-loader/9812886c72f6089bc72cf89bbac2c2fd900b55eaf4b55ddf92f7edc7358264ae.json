{"ast":null,"code":"import _regeneratorRuntime from \"D:/EcoPaw/carbonfootprint_\\u672C\\u5730\\u7248/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/EcoPaw/carbonfootprint_\\u672C\\u5730\\u7248/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"D:/EcoPaw/carbonfootprint_\\u672C\\u5730\\u7248/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.every.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.reduce.js\";\nimport \"core-js/modules/es.array.some.js\";\nimport \"core-js/modules/es.array.splice.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.every.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.parse-float.js\";\nimport \"core-js/modules/web.timers.js\";\nimport { ref, computed } from 'vue';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\nimport { getAPI } from '@/config/api';\nexport default {\n  name: 'CarbonReductionCalculator',\n  emits: ['reductionSaved'],\n  setup: function setup(props, _ref) {\n    var emit = _ref.emit;\n    var store = useStore();\n    var router = useRouter();\n    var showSuccess = ref(false);\n    var showError = ref(false);\n    var errorMessage = ref('');\n    var isSaving = ref(false);\n\n    // 减碳活动分类\n    var categories = [{\n      id: 'transport',\n      name: '交通出行',\n      icon: 'fas fa-car'\n    }, {\n      id: 'energy',\n      name: '能源使用',\n      icon: 'fas fa-bolt'\n    }, {\n      id: 'food',\n      name: '饮食选择',\n      icon: 'fas fa-utensils'\n    }, {\n      id: 'waste',\n      name: '垃圾处理',\n      icon: 'fas fa-trash'\n    }, {\n      id: 'lifestyle',\n      name: '生活方式',\n      icon: 'fas fa-heart'\n    }];\n\n    // 减碳活动列表\n    var activities = [{\n      id: 'bike',\n      category: 'transport',\n      name: '骑自行车出行',\n      description: '使用自行车代替机动车出行',\n      icon: 'fas fa-bicycle',\n      factor: 0.22,\n      unit: '公里'\n    }, {\n      id: 'public_transport',\n      category: 'transport',\n      name: '乘坐公共交通',\n      description: '使用公交、地铁等公共交通工具',\n      icon: 'fas fa-bus',\n      factor: 0.12,\n      unit: '公里'\n    }, {\n      id: 'walk',\n      category: 'transport',\n      name: '步行出行',\n      description: '选择步行代替其他交通方式',\n      icon: 'fas fa-walking',\n      factor: 0.25,\n      unit: '公里'\n    }, {\n      id: 'led_light',\n      category: 'energy',\n      name: '使用LED灯',\n      description: '使用LED节能灯泡',\n      icon: 'fas fa-lightbulb',\n      factor: 0.05,\n      unit: '小时'\n    }, {\n      id: 'solar_panel',\n      category: 'energy',\n      name: '使用太阳能',\n      description: '使用太阳能热水器或发电',\n      icon: 'fas fa-solar-panel',\n      factor: 0.7,\n      unit: '千瓦时'\n    }, {\n      id: 'vegetarian',\n      category: 'food',\n      name: '素食饮食',\n      description: '选择素食代替肉类',\n      icon: 'fas fa-leaf',\n      factor: 2.5,\n      unit: '餐'\n    }, {\n      id: 'local_food',\n      category: 'food',\n      name: '本地食材',\n      description: '选择本地生产的食材',\n      icon: 'fas fa-store',\n      factor: 0.4,\n      unit: '公斤'\n    }, {\n      id: 'recycle',\n      category: 'waste',\n      name: '垃圾分类回收',\n      description: '正确分类和回收垃圾',\n      icon: 'fas fa-recycle',\n      factor: 0.5,\n      unit: '公斤'\n    }, {\n      id: 'compost',\n      category: 'waste',\n      name: '厨余堆肥',\n      description: '将厨余垃圾进行堆肥处理',\n      icon: 'fas fa-seedling',\n      factor: 0.6,\n      unit: '公斤'\n    }, {\n      id: 'reusable_bag',\n      category: 'lifestyle',\n      name: '使用环保袋',\n      description: '使用可重复使用的购物袋',\n      icon: 'fas fa-shopping-bag',\n      factor: 0.05,\n      unit: '次'\n    }, {\n      id: 'reusable_bottle',\n      category: 'lifestyle',\n      name: '使用环保水杯',\n      description: '使用可重复使用的水杯',\n      icon: 'fas fa-glass-whiskey',\n      factor: 0.15,\n      unit: '次'\n    }];\n    var activeCategory = ref('transport');\n    var selectedActivities = ref([]);\n    var totalReduction = ref(0);\n\n    // 根据当前分类筛选活动\n    var filteredActivities = computed(function () {\n      return activities.filter(function (activity) {\n        return activity.category === activeCategory.value;\n      });\n    });\n\n    // 设置当前活动分类\n    var setActiveCategory = function setActiveCategory(categoryId) {\n      activeCategory.value = categoryId;\n    };\n\n    // 检查活动是否已选择\n    var isActivitySelected = function isActivitySelected(activityId) {\n      return selectedActivities.value.some(function (activity) {\n        return activity.id === activityId;\n      });\n    };\n\n    // 切换活动选择状态\n    var toggleActivity = function toggleActivity(activity) {\n      var index = selectedActivities.value.findIndex(function (item) {\n        return item.id === activity.id;\n      });\n      if (index === -1) {\n        selectedActivities.value.push(_objectSpread(_objectSpread({}, activity), {}, {\n          amount: 0\n        }));\n      } else {\n        selectedActivities.value.splice(index, 1);\n      }\n      calculateTotalReduction();\n    };\n\n    // 移除已选活动\n    var removeActivity = function removeActivity(activityId) {\n      selectedActivities.value = selectedActivities.value.filter(function (activity) {\n        return activity.id !== activityId;\n      });\n      calculateTotalReduction();\n    };\n\n    // 计算总减碳量\n    var calculateTotalReduction = function calculateTotalReduction() {\n      totalReduction.value = selectedActivities.value.reduce(function (total, activity) {\n        return total + activity.amount * activity.factor;\n      }, 0);\n    };\n\n    // 检查是否可以保存\n    var canSave = computed(function () {\n      return selectedActivities.value.length > 0 && selectedActivities.value.every(function (activity) {\n        return activity.amount > 0;\n      });\n    });\n\n    // 保存减碳记录\n    var saveReduction = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var invalidActivity, activitiesData, token, api, response, newTotal, _response$data, _error$response, _error$response2, _error$response3, serverError, serverDetails;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(!canSave.value || isSaving.value)) {\n                _context2.next = 2;\n                break;\n              }\n              return _context2.abrupt(\"return\");\n            case 2:\n              isSaving.value = true;\n              showSuccess.value = false;\n              showError.value = false;\n\n              // 检查输入值的有效性\n              invalidActivity = selectedActivities.value.find(function (activity) {\n                return !activity.amount || isNaN(activity.amount) || activity.amount <= 0;\n              });\n              if (!invalidActivity) {\n                _context2.next = 11;\n                break;\n              }\n              showError.value = true;\n              errorMessage.value = \"\\u8BF7\\u4E3A\\u300C\".concat(invalidActivity.name, \"\\u300D\\u8F93\\u5165\\u6709\\u6548\\u7684\\u6570\\u91CF\");\n              isSaving.value = false;\n              return _context2.abrupt(\"return\");\n            case 11:\n              _context2.prev = 11;\n              // 准备提交的数据，确保reduction是数字类型\n              activitiesData = selectedActivities.value.map(function (activity) {\n                return {\n                  id: activity.id,\n                  name: activity.name,\n                  amount: parseFloat(activity.amount),\n                  reduction: parseFloat((activity.amount * activity.factor).toFixed(2))\n                };\n              });\n              console.log('发送减碳数据:', activitiesData);\n\n              // 检查用户token是否存在\n              token = localStorage.getItem('token');\n              if (token) {\n                _context2.next = 20;\n                break;\n              }\n              showError.value = true;\n              errorMessage.value = '未登录状态下可以计算减碳量，但需要登录才能保存记录。';\n              // 不再强制跳转到登录页面\n              isSaving.value = false;\n              return _context2.abrupt(\"return\");\n            case 20:\n              console.log('请求开始，准备发送POST请求到:', '/carbon/reduction');\n              _context2.prev = 21;\n              // 获取配置好的axios实例\n              api = getAPI(); // 打印请求配置\n              console.log('API配置:', {\n                baseURL: api.defaults.baseURL,\n                timeout: api.defaults.timeout,\n                headers: api.defaults.headers\n              });\n\n              // 发送请求\n              _context2.next = 26;\n              return api.post('/carbon/reduction', {\n                activities: activitiesData\n              });\n            case 26:\n              response = _context2.sent;\n              console.log('请求成功，服务器响应:', response.data);\n              if (response.data && response.data.success) {\n                // 清空已选活动\n                selectedActivities.value = [];\n                // 重置总减碳量\n                totalReduction.value = 0;\n\n                // 显示成功消息\n                showSuccess.value = true;\n\n                // 通知父组件更新用户减碳总量\n                newTotal = response.data.data.newTotalReduction || 0;\n                console.log('新的减碳总量:', newTotal);\n                emit('reductionSaved', newTotal);\n\n                // 延迟刷新\n                setTimeout(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n                  return _regeneratorRuntime().wrap(function _callee$(_context) {\n                    while (1) switch (_context.prev = _context.next) {\n                      case 0:\n                        _context.prev = 0;\n                        _context.next = 3;\n                        return store.dispatch('updateUserCarbonReduction');\n                      case 3:\n                        _context.next = 5;\n                        return store.dispatch('syncLeaderboardWithCarbonReduction');\n                      case 5:\n                        console.log('已同步排名系统数据');\n                        _context.next = 11;\n                        break;\n                      case 8:\n                        _context.prev = 8;\n                        _context.t0 = _context[\"catch\"](0);\n                        console.error('刷新数据失败:', _context.t0);\n                      case 11:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }, _callee, null, [[0, 8]]);\n                })), 1500);\n              } else {\n                showError.value = true;\n                errorMessage.value = ((_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.error) || '保存失败，请重试';\n                console.error('保存失败，响应中没有success标志:', response.data);\n              }\n              _context2.next = 35;\n              break;\n            case 31:\n              _context2.prev = 31;\n              _context2.t0 = _context2[\"catch\"](21);\n              console.error('API调用失败:', _context2.t0);\n              throw _context2.t0;\n            case 35:\n              _context2.next = 44;\n              break;\n            case 37:\n              _context2.prev = 37;\n              _context2.t1 = _context2[\"catch\"](11);\n              console.error('保存减碳记录失败:', _context2.t1);\n              showError.value = true;\n\n              // 提取详细的错误信息\n              serverError = ((_error$response = _context2.t1.response) === null || _error$response === void 0 || (_error$response = _error$response.data) === null || _error$response === void 0 ? void 0 : _error$response.error) || ((_error$response2 = _context2.t1.response) === null || _error$response2 === void 0 || (_error$response2 = _error$response2.data) === null || _error$response2 === void 0 ? void 0 : _error$response2.message);\n              serverDetails = (_error$response3 = _context2.t1.response) === null || _error$response3 === void 0 || (_error$response3 = _error$response3.data) === null || _error$response3 === void 0 ? void 0 : _error$response3.details;\n              if (serverError) {\n                errorMessage.value = serverDetails ? \"\".concat(serverError, \": \").concat(serverDetails) : serverError;\n                console.error('服务器返回错误:', serverError, serverDetails);\n              } else if (_context2.t1.request) {\n                // 请求发出但没有收到响应\n                errorMessage.value = '服务器无响应，请检查网络连接';\n                console.error('请求无响应:', _context2.t1.request);\n              } else {\n                // 请求设置或发送前出错\n                errorMessage.value = '请求发送失败，请稍后重试';\n                console.error('请求发送错误:', _context2.t1.message);\n              }\n            case 44:\n              _context2.prev = 44;\n              isSaving.value = false;\n              return _context2.finish(44);\n            case 47:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[11, 37, 44, 47], [21, 31]]);\n      }));\n      return function saveReduction() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    return {\n      categories: categories,\n      activeCategory: activeCategory,\n      filteredActivities: filteredActivities,\n      selectedActivities: selectedActivities,\n      totalReduction: totalReduction,\n      showSuccess: showSuccess,\n      showError: showError,\n      errorMessage: errorMessage,\n      isSaving: isSaving,\n      canSave: canSave,\n      setActiveCategory: setActiveCategory,\n      isActivitySelected: isActivitySelected,\n      toggleActivity: toggleActivity,\n      removeActivity: removeActivity,\n      calculateTotalReduction: calculateTotalReduction,\n      saveReduction: saveReduction\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","useStore","useRouter","getAPI","name","emits","setup","props","_ref","emit","store","router","showSuccess","showError","errorMessage","isSaving","categories","id","icon","activities","category","description","factor","unit","activeCategory","selectedActivities","totalReduction","filteredActivities","filter","activity","value","setActiveCategory","categoryId","isActivitySelected","activityId","some","toggleActivity","index","findIndex","item","push","_objectSpread","amount","splice","calculateTotalReduction","removeActivity","reduce","total","canSave","length","every","saveReduction","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","invalidActivity","activitiesData","token","api","response","newTotal","_response$data","_error$response","_error$response2","_error$response3","serverError","serverDetails","wrap","_callee2$","_context2","prev","next","abrupt","find","isNaN","concat","map","parseFloat","reduction","toFixed","console","log","localStorage","getItem","baseURL","defaults","timeout","headers","post","sent","data","success","newTotalReduction","setTimeout","_callee","_callee$","_context","dispatch","t0","error","stop","t1","message","details","request","finish","apply","arguments"],"sources":["D:\\EcoPaw\\carbonfootprint_本地版\\src\\components\\CarbonReductionCalculator.vue"],"sourcesContent":["<template>\n  <div class=\"carbon-reduction-calculator\">\n    <div class=\"calculator-container\">\n      <!-- 左侧分类列表 -->\n      <div class=\"category-list\">\n        <div\n          v-for=\"category in categories\"\n          :key=\"category.id\"\n          class=\"category-item\"\n          :class=\"{ active: activeCategory === category.id }\"\n          @click=\"setActiveCategory(category.id)\"\n        >\n          <i :class=\"category.icon\"></i>\n          <span>{{ category.name }}</span>\n        </div>\n      </div>\n\n      <!-- 中间活动列表 -->\n      <div class=\"activity-list\">\n        <div\n          v-for=\"activity in filteredActivities\"\n          :key=\"activity.id\"\n          class=\"activity-item\"\n          :class=\"{ selected: isActivitySelected(activity.id) }\"\n          @click=\"toggleActivity(activity)\"\n        >\n          <div class=\"activity-icon\">\n            <i :class=\"activity.icon\"></i>\n          </div>\n          <div class=\"activity-info\">\n            <h3>{{ activity.name }}</h3>\n            <p>{{ activity.description }}</p>\n            <div class=\"activity-factor\">\n              <span>减碳系数：</span>\n              <span class=\"factor-value\">{{ activity.factor }} kgCO₂e/{{ activity.unit }}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- 右侧计算面板 -->\n      <div class=\"calculation-panel\">\n        <div class=\"selected-activities\">\n          <h3>已选减碳活动</h3>\n          <div v-if=\"selectedActivities.length === 0\" class=\"no-activities\">\n            <i class=\"fas fa-info-circle\"></i>\n            <p>请从左侧选择减碳活动</p>\n          </div>\n          <div v-else class=\"activity-inputs\">\n            <div v-for=\"activity in selectedActivities\" :key=\"activity.id\" class=\"activity-input\">\n              <div class=\"activity-header\">\n                <span>{{ activity.name }}</span>\n                <button class=\"remove-btn\" @click=\"removeActivity(activity.id)\">\n                  <i class=\"fas fa-times\"></i>\n                </button>\n              </div>\n              <div class=\"input-group\">\n                <input\n                  type=\"number\"\n                  v-model=\"activity.amount\"\n                  :placeholder=\"'输入' + activity.unit\"\n                  min=\"0\"\n                  @input=\"calculateTotalReduction\"\n                />\n                <span class=\"unit\">{{ activity.unit }}</span>\n              </div>\n              <div class=\"reduction-amount\">\n                减碳量：{{ (activity.amount * activity.factor).toFixed(2) }} kgCO₂e\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"total-reduction\">\n          <div class=\"total-header\">\n            <h3>总减碳量</h3>\n            <span class=\"total-value\">{{ totalReduction.toFixed(2) }} kgCO₂e</span>\n          </div>\n          <div class=\"tree-equivalent\">\n            <i class=\"fas fa-tree\"></i>\n            <span>相当于种植了 {{ (totalReduction / 18).toFixed(1) }} 棵树</span>\n          </div>\n        </div>\n\n        <button\n          class=\"save-btn\"\n          :disabled=\"!canSave || isSaving\"\n          @click=\"saveReduction\"\n        >\n          <i class=\"fas fa-save\" v-if=\"!isSaving\"></i>\n          <i class=\"fas fa-spinner fa-spin\" v-else></i>\n          {{ isSaving ? '保存中...' : '保存减碳记录' }}\n        </button>\n      </div>\n    </div>\n\n    <!-- 保存成功提示 -->\n    <div v-if=\"showSuccess\" class=\"success-message success\">\n      <i class=\"fas fa-check-circle\"></i>\n      <div class=\"message-content\">\n        <div class=\"message-title\">减碳记录保存成功！</div>\n      </div>\n      <button class=\"close-message-btn\" @click=\"showSuccess = false\">\n        <i class=\"fas fa-times\"></i>\n      </button>\n    </div>\n    \n    <!-- 保存失败提示 -->\n    <div v-if=\"showError\" class=\"success-message error\">\n      <i class=\"fas fa-exclamation-circle\"></i>\n      <div class=\"message-content\">\n        <div class=\"message-title\">保存失败</div>\n        <div class=\"message-detail\">{{ errorMessage }}</div>\n      </div>\n      <button class=\"close-message-btn\" @click=\"showError = false\">\n        <i class=\"fas fa-times\"></i>\n      </button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, computed } from 'vue'\nimport { useStore } from 'vuex'\nimport { useRouter } from 'vue-router'\nimport { getAPI } from '@/config/api'\n\nexport default {\n  name: 'CarbonReductionCalculator',\n  emits: ['reductionSaved'],\n  setup(props, { emit }) {\n    const store = useStore()\n    const router = useRouter()\n    const showSuccess = ref(false)\n    const showError = ref(false)\n    const errorMessage = ref('')\n    const isSaving = ref(false)\n\n    // 减碳活动分类\n    const categories = [\n      { id: 'transport', name: '交通出行', icon: 'fas fa-car' },\n      { id: 'energy', name: '能源使用', icon: 'fas fa-bolt' },\n      { id: 'food', name: '饮食选择', icon: 'fas fa-utensils' },\n      { id: 'waste', name: '垃圾处理', icon: 'fas fa-trash' },\n      { id: 'lifestyle', name: '生活方式', icon: 'fas fa-heart' }\n    ]\n\n    // 减碳活动列表\n    const activities = [\n      {\n        id: 'bike',\n        category: 'transport',\n        name: '骑自行车出行',\n        description: '使用自行车代替机动车出行',\n        icon: 'fas fa-bicycle',\n        factor: 0.22,\n        unit: '公里'\n      },\n      {\n        id: 'public_transport',\n        category: 'transport',\n        name: '乘坐公共交通',\n        description: '使用公交、地铁等公共交通工具',\n        icon: 'fas fa-bus',\n        factor: 0.12,\n        unit: '公里'\n      },\n      {\n        id: 'walk',\n        category: 'transport',\n        name: '步行出行',\n        description: '选择步行代替其他交通方式',\n        icon: 'fas fa-walking',\n        factor: 0.25,\n        unit: '公里'\n      },\n      {\n        id: 'led_light',\n        category: 'energy',\n        name: '使用LED灯',\n        description: '使用LED节能灯泡',\n        icon: 'fas fa-lightbulb',\n        factor: 0.05,\n        unit: '小时'\n      },\n      {\n        id: 'solar_panel',\n        category: 'energy',\n        name: '使用太阳能',\n        description: '使用太阳能热水器或发电',\n        icon: 'fas fa-solar-panel',\n        factor: 0.7,\n        unit: '千瓦时'\n      },\n      {\n        id: 'vegetarian',\n        category: 'food',\n        name: '素食饮食',\n        description: '选择素食代替肉类',\n        icon: 'fas fa-leaf',\n        factor: 2.5,\n        unit: '餐'\n      },\n      {\n        id: 'local_food',\n        category: 'food',\n        name: '本地食材',\n        description: '选择本地生产的食材',\n        icon: 'fas fa-store',\n        factor: 0.4,\n        unit: '公斤'\n      },\n      {\n        id: 'recycle',\n        category: 'waste',\n        name: '垃圾分类回收',\n        description: '正确分类和回收垃圾',\n        icon: 'fas fa-recycle',\n        factor: 0.5,\n        unit: '公斤'\n      },\n      {\n        id: 'compost',\n        category: 'waste',\n        name: '厨余堆肥',\n        description: '将厨余垃圾进行堆肥处理',\n        icon: 'fas fa-seedling',\n        factor: 0.6,\n        unit: '公斤'\n      },\n      {\n        id: 'reusable_bag',\n        category: 'lifestyle',\n        name: '使用环保袋',\n        description: '使用可重复使用的购物袋',\n        icon: 'fas fa-shopping-bag',\n        factor: 0.05,\n        unit: '次'\n      },\n      {\n        id: 'reusable_bottle',\n        category: 'lifestyle',\n        name: '使用环保水杯',\n        description: '使用可重复使用的水杯',\n        icon: 'fas fa-glass-whiskey',\n        factor: 0.15,\n        unit: '次'\n      }\n    ]\n\n    const activeCategory = ref('transport')\n    const selectedActivities = ref([])\n    const totalReduction = ref(0)\n\n    // 根据当前分类筛选活动\n    const filteredActivities = computed(() => {\n      return activities.filter(activity => activity.category === activeCategory.value)\n    })\n\n    // 设置当前活动分类\n    const setActiveCategory = (categoryId) => {\n      activeCategory.value = categoryId\n    }\n\n    // 检查活动是否已选择\n    const isActivitySelected = (activityId) => {\n      return selectedActivities.value.some(activity => activity.id === activityId)\n    }\n\n    // 切换活动选择状态\n    const toggleActivity = (activity) => {\n      const index = selectedActivities.value.findIndex(item => item.id === activity.id)\n      if (index === -1) {\n        selectedActivities.value.push({\n          ...activity,\n          amount: 0\n        })\n      } else {\n        selectedActivities.value.splice(index, 1)\n      }\n      calculateTotalReduction()\n    }\n\n    // 移除已选活动\n    const removeActivity = (activityId) => {\n      selectedActivities.value = selectedActivities.value.filter(\n        activity => activity.id !== activityId\n      )\n      calculateTotalReduction()\n    }\n\n    // 计算总减碳量\n    const calculateTotalReduction = () => {\n      totalReduction.value = selectedActivities.value.reduce((total, activity) => {\n        return total + (activity.amount * activity.factor)\n      }, 0)\n    }\n\n    // 检查是否可以保存\n    const canSave = computed(() => {\n      return selectedActivities.value.length > 0 &&\n        selectedActivities.value.every(activity => activity.amount > 0)\n    })\n\n    // 保存减碳记录\n    const saveReduction = async () => {\n      if (!canSave.value || isSaving.value) return\n      \n      isSaving.value = true\n      showSuccess.value = false\n      showError.value = false\n      \n      // 检查输入值的有效性\n      const invalidActivity = selectedActivities.value.find(activity => \n        !activity.amount || isNaN(activity.amount) || activity.amount <= 0\n      )\n      \n      if (invalidActivity) {\n        showError.value = true\n        errorMessage.value = `请为「${invalidActivity.name}」输入有效的数量`\n        isSaving.value = false\n        return\n      }\n\n      try {\n        // 准备提交的数据，确保reduction是数字类型\n        const activitiesData = selectedActivities.value.map(activity => ({\n          id: activity.id,\n          name: activity.name,\n          amount: parseFloat(activity.amount),\n          reduction: parseFloat((activity.amount * activity.factor).toFixed(2))\n        }))\n        \n        console.log('发送减碳数据:', activitiesData)\n        \n        // 检查用户token是否存在\n        const token = localStorage.getItem('token')\n        if (!token) {\n          showError.value = true\n          errorMessage.value = '未登录状态下可以计算减碳量，但需要登录才能保存记录。'\n          // 不再强制跳转到登录页面\n          isSaving.value = false\n          return\n        }\n        \n        console.log('请求开始，准备发送POST请求到:', '/carbon/reduction')\n        \n        try {\n          // 获取配置好的axios实例\n          const api = getAPI()\n          \n          // 打印请求配置\n          console.log('API配置:', {\n            baseURL: api.defaults.baseURL,\n            timeout: api.defaults.timeout,\n            headers: api.defaults.headers\n          })\n          \n          // 发送请求\n          const response = await api.post('/carbon/reduction', {\n            activities: activitiesData\n          })\n          \n          console.log('请求成功，服务器响应:', response.data)\n          \n          if (response.data && response.data.success) {\n            // 清空已选活动\n            selectedActivities.value = []\n            // 重置总减碳量\n            totalReduction.value = 0\n            \n            // 显示成功消息\n            showSuccess.value = true\n            \n            // 通知父组件更新用户减碳总量\n            const newTotal = response.data.data.newTotalReduction || 0\n            console.log('新的减碳总量:', newTotal)\n            emit('reductionSaved', newTotal)\n            \n            // 延迟刷新\n            setTimeout(async () => {\n              try {\n                // 直接刷新当前页面的数据\n                await store.dispatch('updateUserCarbonReduction')\n                \n                // 同步更新排名系统\n                await store.dispatch('syncLeaderboardWithCarbonReduction')\n                console.log('已同步排名系统数据')\n              } catch (refreshError) {\n                console.error('刷新数据失败:', refreshError)\n              }\n            }, 1500)\n          } else {\n            showError.value = true\n            errorMessage.value = response.data?.error || '保存失败，请重试'\n            console.error('保存失败，响应中没有success标志:', response.data)\n          }\n        } catch (apiError) {\n          console.error('API调用失败:', apiError)\n          throw apiError\n        }\n      } catch (error) {\n        console.error('保存减碳记录失败:', error)\n        showError.value = true\n        \n        // 提取详细的错误信息\n        const serverError = error.response?.data?.error || error.response?.data?.message\n        const serverDetails = error.response?.data?.details\n        \n        if (serverError) {\n          errorMessage.value = serverDetails \n            ? `${serverError}: ${serverDetails}`\n            : serverError\n          console.error('服务器返回错误:', serverError, serverDetails)\n        } else if (error.request) {\n          // 请求发出但没有收到响应\n          errorMessage.value = '服务器无响应，请检查网络连接'\n          console.error('请求无响应:', error.request)\n        } else {\n          // 请求设置或发送前出错\n          errorMessage.value = '请求发送失败，请稍后重试'\n          console.error('请求发送错误:', error.message)\n        }\n      } finally {\n        isSaving.value = false\n      }\n    }\n\n    return {\n      categories,\n      activeCategory,\n      filteredActivities,\n      selectedActivities,\n      totalReduction,\n      showSuccess,\n      showError,\n      errorMessage,\n      isSaving,\n      canSave,\n      setActiveCategory,\n      isActivitySelected,\n      toggleActivity,\n      removeActivity,\n      calculateTotalReduction,\n      saveReduction\n    }\n  }\n}\n</script>\n\n<style scoped>\n.carbon-reduction-calculator {\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 0 20px;\n}\n\n.calculator-header {\n  text-align: center;\n  margin-bottom: 30px;\n  display: none; /* 隐藏重复的标题 */\n}\n\n.calculator-container {\n  display: flex;\n  gap: 20px;\n  background: #fff;\n  border-radius: 10px;\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);\n  padding: 20px;\n}\n\n.category-list {\n  width: 200px;\n  border-right: 1px solid #eee;\n  padding-right: 20px;\n}\n\n.category-item {\n  display: flex;\n  align-items: center;\n  padding: 12px 15px;\n  margin-bottom: 10px;\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.category-item:hover {\n  background: #f5f5f5;\n}\n\n.category-item.active {\n  background: #e3f2fd;\n  color: #1976d2;\n}\n\n.category-item i {\n  margin-right: 10px;\n  font-size: 18px;\n}\n\n.activity-list {\n  flex: 1;\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n  gap: 15px;\n  padding: 0 20px;\n  max-height: 600px;\n  overflow-y: auto;\n}\n\n.activity-item {\n  background: #fff;\n  border: 1px solid #eee;\n  border-radius: 8px;\n  padding: 15px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.activity-item:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.activity-item.selected {\n  border-color: #4caf50;\n  background: #f1f8e9;\n}\n\n.activity-icon {\n  width: 40px;\n  height: 40px;\n  background: #f5f5f5;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 10px;\n}\n\n.activity-icon i {\n  font-size: 20px;\n  color: #666;\n}\n\n.activity-info h3 {\n  font-size: 16px;\n  margin-bottom: 5px;\n  color: #2c3e50;\n}\n\n.activity-info p {\n  font-size: 14px;\n  color: #666;\n  margin-bottom: 10px;\n}\n\n.activity-factor {\n  font-size: 14px;\n  color: #666;\n}\n\n.factor-value {\n  color: #4caf50;\n  font-weight: bold;\n}\n\n.calculation-panel {\n  width: 300px;\n  border-left: 1px solid #eee;\n  padding-left: 20px;\n}\n\n.selected-activities {\n  margin-bottom: 20px;\n}\n\n.selected-activities h3 {\n  font-size: 18px;\n  margin-bottom: 15px;\n  color: #2c3e50;\n}\n\n.no-activities {\n  text-align: center;\n  padding: 20px;\n  color: #999;\n}\n\n.no-activities i {\n  font-size: 24px;\n  margin-bottom: 10px;\n}\n\n.activity-inputs {\n  max-height: 300px;\n  overflow-y: auto;\n}\n\n.activity-input {\n  background: #f5f5f5;\n  border-radius: 8px;\n  padding: 15px;\n  margin-bottom: 10px;\n}\n\n.activity-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10px;\n}\n\n.remove-btn {\n  background: none;\n  border: none;\n  color: #999;\n  cursor: pointer;\n  padding: 5px;\n}\n\n.remove-btn:hover {\n  color: #f44336;\n}\n\n.input-group {\n  display: flex;\n  align-items: center;\n  margin-bottom: 10px;\n}\n\n.input-group input {\n  flex: 1;\n  padding: 8px 12px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  margin-right: 10px;\n}\n\n.unit {\n  color: #666;\n  font-size: 14px;\n}\n\n.reduction-amount {\n  font-size: 14px;\n  color: #4caf50;\n}\n\n.total-reduction {\n  background: #e8f5e9;\n  border-radius: 8px;\n  padding: 20px;\n  margin-bottom: 20px;\n}\n\n.total-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10px;\n}\n\n.total-value {\n  font-size: 24px;\n  font-weight: bold;\n  color: #4caf50;\n}\n\n.tree-equivalent {\n  display: flex;\n  align-items: center;\n  color: #666;\n}\n\n.tree-equivalent i {\n  margin-right: 10px;\n  color: #4caf50;\n}\n\n.save-btn {\n  width: 100%;\n  padding: 12px;\n  background: #4caf50;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background 0.3s ease;\n}\n\n.save-btn:hover {\n  background: #43a047;\n}\n\n.save-btn:disabled {\n  background: #cccccc;\n  cursor: not-allowed;\n}\n\n.save-btn i {\n  margin-right: 8px;\n}\n\n.success-message {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  color: white;\n  padding: 15px 25px;\n  border-radius: 4px;\n  display: flex;\n  align-items: flex-start;\n  animation: slideIn 0.3s ease;\n  z-index: 1000;\n  min-width: 300px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.success-message.success {\n  background: #4caf50;\n}\n\n.success-message.error {\n  background: #f44336;\n}\n\n.success-message i {\n  margin-right: 15px;\n  font-size: 24px;\n}\n\n.message-content {\n  flex: 1;\n}\n\n.message-title {\n  font-weight: bold;\n  margin-bottom: 5px;\n}\n\n.message-detail {\n  font-size: 14px;\n  opacity: 0.9;\n}\n\n.close-message-btn {\n  background: none;\n  border: none;\n  color: white;\n  opacity: 0.7;\n  cursor: pointer;\n  font-size: 16px;\n  padding: 0;\n  margin-left: 10px;\n  transition: opacity 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 24px;\n  height: 24px;\n}\n\n.close-message-btn:hover {\n  opacity: 1;\n}\n\n@keyframes slideIn {\n  from {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n  to {\n    transform: translateX(0);\n    opacity: 1;\n  }\n}\n\n/* 按钮加载中状态 */\n.fa-spinner {\n  animation: spin 1s infinite linear;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}