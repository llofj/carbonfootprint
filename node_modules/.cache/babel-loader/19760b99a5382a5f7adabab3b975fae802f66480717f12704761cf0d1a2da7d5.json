{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, Fragment as _Fragment, createElementBlock as _createElementBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"navbar\"\n};\nvar _hoisted_2 = {\n  \"class\": \"nav-brand\"\n};\nvar _hoisted_3 = {\n  \"class\": \"nav-links\"\n};\nvar _hoisted_4 = {\n  \"class\": \"nav-auth\"\n};\nvar _hoisted_5 = {\n  \"class\": \"username\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"nav\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_router_link, {\n    to: \"/\",\n    \"class\": \"brand-link\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[1] || (_cache[1] = [_createElementVNode(\"span\", {\n        \"class\": \"brand-name\"\n      }, \"EcoPaw\", -1 /* HOISTED */)]);\n    }),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_router_link, {\n    to: \"/calculator\",\n    \"class\": \"nav-link\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[2] || (_cache[2] = [_createTextVNode(\"碳计算器\")]);\n    }),\n    _: 1 /* STABLE */\n  }), $data.isLoggedIn ? (_openBlock(), _createBlock(_component_router_link, {\n    key: 0,\n    to: \"/pet\",\n    \"class\": \"nav-link\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[3] || (_cache[3] = [_createTextVNode(\"虚拟宠物\")]);\n    }),\n    _: 1 /* STABLE */\n  })) : (_openBlock(), _createBlock(_component_router_link, {\n    key: 1,\n    to: \"/login\",\n    \"class\": \"nav-link disabled\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[4] || (_cache[4] = [_createTextVNode(\"虚拟宠物\")]);\n    }),\n    _: 1 /* STABLE */\n  })), $data.isLoggedIn ? (_openBlock(), _createBlock(_component_router_link, {\n    key: 2,\n    to: \"/achievements\",\n    \"class\": \"nav-link\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[5] || (_cache[5] = [_createTextVNode(\"成就系统\")]);\n    }),\n    _: 1 /* STABLE */\n  })) : (_openBlock(), _createBlock(_component_router_link, {\n    key: 3,\n    to: \"/login\",\n    \"class\": \"nav-link disabled\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[6] || (_cache[6] = [_createTextVNode(\"成就系统\")]);\n    }),\n    _: 1 /* STABLE */\n  })), $data.isLoggedIn ? (_openBlock(), _createBlock(_component_router_link, {\n    key: 4,\n    to: \"/leaderboard\",\n    \"class\": \"nav-link\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[7] || (_cache[7] = [_createTextVNode(\"排名系统\")]);\n    }),\n    _: 1 /* STABLE */\n  })) : (_openBlock(), _createBlock(_component_router_link, {\n    key: 5,\n    to: \"/login\",\n    \"class\": \"nav-link disabled\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[8] || (_cache[8] = [_createTextVNode(\"排名系统\")]);\n    }),\n    _: 1 /* STABLE */\n  }))]), _createElementVNode(\"div\", _hoisted_4, [$data.isLoggedIn ? (_openBlock(), _createElementBlock(_Fragment, {\n    key: 0\n  }, [_createElementVNode(\"span\", _hoisted_5, _toDisplayString($data.username), 1 /* TEXT */), _createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = function () {\n      return $options.logout && $options.logout.apply($options, arguments);\n    }),\n    \"class\": \"logout-btn\"\n  }, _cache[9] || (_cache[9] = [_createElementVNode(\"i\", {\n    \"class\": \"fas fa-sign-out-alt\"\n  }, null, -1 /* HOISTED */)]))], 64 /* STABLE_FRAGMENT */)) : (_openBlock(), _createBlock(_component_router_link, {\n    key: 1,\n    to: \"/login\",\n    \"class\": \"login-link\"\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[10] || (_cache[10] = [_createElementVNode(\"i\", {\n        \"class\": \"fas fa-user\"\n      }, null, -1 /* HOISTED */)]);\n    }),\n    _: 1 /* STABLE */\n  }))])]);\n}","map":{"version":3,"names":["_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_router_link","to","_withCtx","_cache","_","_hoisted_3","_createTextVNode","$data","isLoggedIn","_createBlock","key","_hoisted_4","_Fragment","_hoisted_5","_toDisplayString","username","onClick","$options","logout","apply","arguments"],"sources":["D:\\computer_design\\src\\components\\Navbar.vue"],"sourcesContent":["<template>\r\n  <nav class=\"navbar\">\r\n    <div class=\"nav-brand\">\r\n      <router-link to=\"/\" class=\"brand-link\">\r\n        <span class=\"brand-name\">EcoPaw</span>\r\n      </router-link>\r\n    </div>\r\n    \r\n    <div class=\"nav-links\">\r\n      <router-link to=\"/calculator\" class=\"nav-link\">碳计算器</router-link>\r\n      <router-link v-if=\"isLoggedIn\" to=\"/pet\" class=\"nav-link\">虚拟宠物</router-link>\r\n      <router-link v-else to=\"/login\" class=\"nav-link disabled\">虚拟宠物</router-link>\r\n      <router-link v-if=\"isLoggedIn\" to=\"/achievements\" class=\"nav-link\">成就系统</router-link>\r\n      <router-link v-else to=\"/login\" class=\"nav-link disabled\">成就系统</router-link>\r\n      <router-link v-if=\"isLoggedIn\" to=\"/leaderboard\" class=\"nav-link\">排名系统</router-link>\r\n      <router-link v-else to=\"/login\" class=\"nav-link disabled\">排名系统</router-link>\r\n    </div>\r\n    \r\n    <div class=\"nav-auth\">\r\n      <template v-if=\"isLoggedIn\">\r\n        <span class=\"username\">{{ username }}</span>\r\n        <button @click=\"logout\" class=\"logout-btn\">\r\n          <i class=\"fas fa-sign-out-alt\"></i>\r\n        </button>\r\n      </template>\r\n      <router-link v-else to=\"/login\" class=\"login-link\">\r\n        <i class=\"fas fa-user\"></i>\r\n      </router-link>\r\n    </div>\r\n  </nav>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  name: 'Navbar',\r\n  data() {\r\n    return {\r\n      isLoggedIn: false,\r\n      username: ''\r\n    };\r\n  },\r\n  created() {\r\n    this.checkLoginStatus();\r\n    window.addEventListener('storage', this.checkLoginStatus);\r\n  },\r\n  unmounted() {\r\n    window.removeEventListener('storage', this.checkLoginStatus);\r\n  },\r\n  methods: {\r\n    checkLoginStatus() {\r\n      const token = localStorage.getItem('token');\r\n      const username = localStorage.getItem('username');\r\n      \r\n      if (token && username) {\r\n        this.isLoggedIn = true;\r\n        this.username = username;\r\n      } else {\r\n        this.isLoggedIn = false;\r\n        this.username = '';\r\n      }\r\n    },\r\n    async logout() {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        if (token) {\r\n          // 调用后端登出接口\r\n          await axios.post('http://localhost:5000/api/auth/logout', {}, {\r\n            headers: { Authorization: `Bearer ${token}` }\r\n          });\r\n        }\r\n      } catch (error) {\r\n        console.error('Logout error:', error);\r\n      } finally {\r\n        // 清除所有存储的数据\r\n        localStorage.clear();\r\n        sessionStorage.clear();\r\n        \r\n        // 重置状态\r\n        this.isLoggedIn = false;\r\n        this.username = '';\r\n        \r\n        // 强制刷新路由状态\r\n        await this.$router.push('/');\r\n        window.location.reload();\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    $route() {\r\n      this.checkLoginStatus();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.navbar {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  height: 64px;\r\n  background-color: #ffffff;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 0 2rem;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  z-index: 1000;\r\n}\r\n\r\n.nav-brand {\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.brand-link {\r\n  text-decoration: none;\r\n  color: #2196F3;\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n  letter-spacing: 1px;\r\n}\r\n\r\n.nav-links {\r\n  display: flex;\r\n  gap: 2rem;\r\n}\r\n\r\n.nav-link {\r\n  text-decoration: none;\r\n  color: #333;\r\n  font-size: 16px;\r\n  padding: 8px 12px;\r\n  border-radius: 4px;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.nav-link:hover {\r\n  background-color: #f5f5f5;\r\n  color: #2196F3;\r\n}\r\n\r\n.nav-link.router-link-active {\r\n  color: #2196F3;\r\n  font-weight: 500;\r\n}\r\n\r\n.nav-link.disabled {\r\n  color: #999;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.nav-auth {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1rem;\r\n}\r\n\r\n.username {\r\n  color: #333;\r\n  font-size: 16px;\r\n}\r\n\r\n.login-link {\r\n  color: #666;\r\n  font-size: 20px;\r\n  text-decoration: none;\r\n  padding: 8px;\r\n  border-radius: 50%;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.login-link:hover {\r\n  background-color: #f5f5f5;\r\n  color: #2196F3;\r\n}\r\n\r\n.logout-btn {\r\n  background: none;\r\n  border: none;\r\n  color: #666;\r\n  font-size: 20px;\r\n  cursor: pointer;\r\n  padding: 8px;\r\n  border-radius: 50%;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.logout-btn:hover {\r\n  background-color: #f5f5f5;\r\n  color: #ff5252;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}